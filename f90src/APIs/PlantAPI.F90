module PlantAPI

  use data_kind_mod, only : r8 => SHR_KIND_R8
  use ExtractMod   , only : extract
  use grosubMod    , only : grosub
  use HfuncMod     , only : hfunc
  use HfuncsMod    , only : hfuncs
  use UptakeMod    , only : uptake
  use timings      , only : start_timer, end_timer
  use EcoSIMHistMod
  use SnowDataType , only : TKW,DPTHS
  use SurfLitterDataType
  use LandSurfDataType
  use SoilPropertyDataType
  use ChemTranspDataType
  use SoilHeatDataType
  use SOMDataType
  use ClimForcDataType
  use EcoSIMCtrlDataType
  use GridDataType
  use RootDataType
  use SoilWaterDataType
  use CanopyDataType
  use PlantDataRateType
  use PlantTraitDataType
  use CanopyRadDataType
  use FlagDataType
  use EcosysBGCFluxType
  use FertilizerDataType
  use SoilBGCDataType
  use PlantMngmtDataType
  use PlantAPIData
implicit none

  private
  public :: PlantModel
  contains

  subroutine PlantModel(I,J,NHW,NHE,NVN,NVS)


  implicit none
  integer, intent(in) :: I,J
  integer, intent(in) :: NHW,NHE,NVN,NVS
  real(r8) :: t1
  integer :: NY,NX

333   FORMAT(A8)

  DO NX=NHW,NHE
    DO NY=NVN,NVS

    call  PlantAPISend(I,J,NY,NX)

!   UPDATE PLANT PHENOLOGY IN 'HFUNC'
!
    !if(lverb)WRITE(*,333)'HFUNC'
    !call start_timer(t1)

      CALL HFUNCs(I,J)
    !call end_timer('HFUNC',t1)

      call PlantAPIRecv(I,J,NY,NX)
    ENDDO
  ENDDO
!  CALL HFUNC(I,J,NHW,NHE,NVN,NVS)
!
!   CALCULATE CANOPY CO2 UPTAKE AT FULL TURGOR, CANOPY WATER POTENTIAL,
!   HYDRAULIC AND STOMATAL RESISTANCES,AND CANOPY ENERGY BALANCE IN 'UPTAKE'
!   CALCULATE ROOT UPTAKE OF WATER, OXYGEN, NH4, NO3 AND PO4 IN 'UPTAKE'
!
  if(lverb)WRITE(*,333)'UPTK'
!    if(I>=170)print*,TKS(0,NVN,NHW)
  call start_timer(t1)
  CALL UPTAKE(I,J,NHW,NHE,NVN,NVS)
  call end_timer('UPTK',t1)
!
!   CALCULATE CANOPY CO2 UPTAKE AT AMBIENT TURGOR, AUTOTROPHIC AND GROWTH
!   RESPIRATION, PLANT C ALLOCATION, CANOPY AND ROOT GROWTH IN 'GROSUB'
!
  if(lverb)WRITE(*,333)'GRO'
!    if(I>=170)print*,TKS(0,NVN,NHW)
  call start_timer(t1)
  CALL GROSUB(I,J,NHW,NHE,NVN,NVS)
  call end_timer('GRO',t1)


!   CALCULATE ROOT-SOIL C AND NUTRIENT EXCHANGE FOR ALL PLANT SPECIES
!   IN 'EXTRACT'
!
  if(lverb)WRITE(*,333)'EXTR'
!    if(I>=170)print*,TKS(0,NVN,NHW)
  call start_timer(t1)
  CALL EXTRACT(I,J,NHW,NHE,NVN,NVS)
  call end_timer('EXTR',t1)

  end subroutine PlantModel

!------------------------------------------------------------------------------------------

  subroutine PlantAPIRecv(I,J,NY,NX)

  implicit none
  integer, intent(in) :: I,J,NY,NX

  integer :: NB,NR,NZ,K,L,M,N,I1
  I1=I+1;if(I1>366)I1=1
  IFLGT(NY,NX)=IFLGTs1
  PPT(NY,NX)=PPTs1
  RECO(NY,NX)=RECOs1
  TNBP(NY,NX)=TNBPs1
  TGPP(NY,NX)=TGPPs1
  TLEC(NY,NX)=TLECs1
  TSHC(NY,NX)=TSHCs1
  TRAU(NY,NX)=TRAUs1
  UVOLO(NY,NX)=UVOLOs1
  XHVSTC(NY,NX)=XHVSTCs1
  XHVSTN(NY,NX)=XHVSTNs1
  XHVSTP(NY,NX)=XHVSTPs1
  FERT(17:19,I1,NY,NX)=FERTs1(17:19,I1)
  FERT(3,I1,NY,NX)=FERTs1(3,I1)
  IYTYP(2,I1,NY,NX)=IYTYPs1

  DO L=NU(NY,NX),NL(NY,NX)
    DO K=0,jcplx1
      XOQCS(K,L,NY,NX)=XOQCSs1(K,L)
      XOQNS(K,L,NY,NX)=XOQNSs1(K,L)
      XOQPS(K,L,NY,NX)=XOQPSs1(K,L)
    ENDDO
    DO M=1,NPH
      ROXSK(M,L,NY,NX)=ROXSKs1(M,L)
    ENDDO
  ENDDO
  DO NZ=1,NP0(NY,NX)
    ARLFP(NZ,NY,NX)=ARLFPs1(NZ)
    ARSTP(NZ,NY,NX)=ARSTPs1(NZ)
    BALC(NZ,NY,NX)=BALCs1(NZ)
    BALN(NZ,NY,NX)=BALNs1(NZ)
    BALP(NZ,NY,NX)=BALPs1(NZ)
    CPOOLP(NZ,NY,NX)=CPOOLPs1(NZ)
    CPOLNP(NZ,NY,NX)=CPOLNPs1(NZ)
    CCPOLP(NZ,NY,NX)=CCPOLPs1(NZ)
    CCPLNP(NZ,NY,NX)=CCPLNPs1(NZ)
    CZPOLP(NZ,NY,NX)=CZPOLPs1(NZ)
    CPPOLP(NZ,NY,NX)=CPPOLPs1(NZ)
    CNET(NZ,NY,NX)=CNETs1(NZ)
    CO2Q(NZ,NY,NX)=CO2Qs1(NZ)
    CO2I(NZ,NY,NX)=CO2Is1(NZ)
    CO2L(NZ,NY,NX)=CO2Ls1(NZ)
    CF(NZ,NY,NX)=CFs1(NZ)
    CNWS(NZ,NY,NX)=CNWSs1(NZ)
    CPWS(NZ,NY,NX)=CPWSs1(NZ)
    CWSRT(NZ,NY,NX)=CWSRTs1(NZ)
    CNRTS(NZ,NY,NX)=CNRTSs1(NZ)
    CPRTS(NZ,NY,NX)=CPRTSs1(NZ)
    CNRT(NZ,NY,NX)=CNRTs1(NZ)
    CPRT(NZ,NY,NX)=CPRTs1(NZ)
    CTRAN(NZ,NY,NX)=CTRANs1(NZ)
    CARBN(NZ,NY,NX)=CARBNs1(NZ)
    CHILL(NZ,NY,NX)=CHILLs1(NZ)
    DCO2(NZ,NY,NX)=DCO2s1(NZ)
    DTKC(NZ,NY,NX)=DTKCs1(NZ)
    ENGYX(NZ,NY,NX)=ENGYXs1(NZ)
    EP(NZ,NY,NX)=EPs1(NZ)
    EVAPC(NZ,NY,NX)=EVAPCs1(NZ)
    EFLXC(NZ,NY,NX)=EFLXCs1(NZ)
    FMOL(NZ,NY,NX)=FMOLs1(NZ)
    FRADP(NZ,NY,NX)=FRADPs1(NZ)
    FNOD(NZ,NY,NX)=FNODs1(NZ)
    GRNO(NZ,NY,NX)=GRNOs1(NZ)
    HCSNC(NZ,NY,NX)=HCSNCs1(NZ)
    HZSNC(NZ,NY,NX)=HZSNCs1(NZ)
    HPSNC(NZ,NY,NX)=HPSNCs1(NZ)
    HCUPTK(NZ,NY,NX)=HCUPTKs1(NZ)
    HZUPTK(NZ,NY,NX)=HZUPTKs1(NZ)
    HPUPTK(NZ,NY,NX)=HPUPTKs1(NZ)
    HTCTL(NZ,NY,NX)=HTCTLs1(NZ)
    HVSTC(NZ,NY,NX)=HVSTCs1(NZ)
    HVSTN(NZ,NY,NX)=HVSTNs1(NZ)
    HVSTP(NZ,NY,NX)=HVSTPs1(NZ)
    HTC(NZ,NY,NX)=HTCs1(NZ)
    HFLXC(NZ,NY,NX)=HFLXCs1(NZ)
    HTSTZ(NZ,NY,NX)=HTSTZs1(NZ)
    IFLGC(NZ,NY,NX)=IFLGCs1(NZ)
    IDTH(NZ,NY,NX)=IDTHs1(NZ)
    IDTHP(NZ,NY,NX)=IDTHPs1(NZ)
    IDTHR(NZ,NY,NX)=IDTHRs1(NZ)
    IDAY0(NZ,NY,NX)=IDAY0s1(NZ)
    IYR0(NZ,NY,NX)=IYR0s1(NZ)
    IFLGI(NZ,NY,NX)=IFLGIs1(NZ)
    IDAYH(NZ,NY,NX)=IDAYHs1(NZ)
    IYRH(NZ,NY,NX)=IYRHs1(NZ)
    NIX(NZ,NY,NX)=NIXs1(NZ)
    NBT(NZ,NY,NX)=NBTs1(NZ)
    NBR(NZ,NY,NX)=NBRs1(NZ)
    NRT(NZ,NY,NX)=NRTs1(NZ)
    NI(NZ,NY,NX)=NIs1(NZ)
    NG(NZ,NY,NX)=NGs1(NZ)
    NB1(NZ,NY,NX)=NB1s1(NZ)
    NNOD(NZ,NY,NX)=NNODs1(NZ)
    O2L(NZ,NY,NX)=O2Ls1(NZ)
    O2I(NZ,NY,NX)=O2Is1(NZ)
    OFFST(NZ,NY,NX)=OFFSTs1(NZ)
    OSTR(NZ,NY,NX)=OSTRs1(NZ)
    PPOOLP(NZ,NY,NX)=PPOOLPs1(NZ)
    PPOLNP(NZ,NY,NX)=PPOLNPs1(NZ)
    PPX(NZ,NY,NX)=PPXs1(NZ)
    PP(NZ,NY,NX)=PPs1(NZ)
    PPI(NZ,NY,NX)=PPIs1(NZ)
    PSILT(NZ,NY,NX)=PSILTs1(NZ)
    PSILO(NZ,NY,NX)=PSILOs1(NZ)
    PSILG(NZ,NY,NX)=PSILGs1(NZ)
    PSILZ(NZ,NY,NX)=PSILZs1(NZ)
    RCO2Z(NZ,NY,NX)=RCO2Zs1(NZ)
    ROXYZ(NZ,NY,NX)=ROXYZs1(NZ)
    RCH4Z(NZ,NY,NX)=RCH4Zs1(NZ)
    RN2OZ(NZ,NY,NX)=RN2OZs1(NZ)
    RNH3Z(NZ,NY,NX)=RNH3Zs1(NZ)
    RH2GZ(NZ,NY,NX)=RH2GZs1(NZ)
    RSMN(NZ,NY,NX)=RSMNs1(NZ)
    RSMH(NZ,NY,NX)=RSMHs1(NZ)
    RCMX(NZ,NY,NX)=RCMXs1(NZ)
    RNH3C(NZ,NY,NX)=RNH3Cs1(NZ)
    RSETC(NZ,NY,NX)=RSETCs1(NZ)
    RSETN(NZ,NY,NX)=RSETNs1(NZ)
    RSETP(NZ,NY,NX)=RSETPs1(NZ)
    RAD1(NZ,NY,NX)=RAD1s1(NZ)
    RAZ(NZ,NY,NX)=RAZs1(NZ)
    RC(NZ,NY,NX)=RCs1(NZ)
    RA(NZ,NY,NX)=RAs1(NZ)
    SDPTHI(NZ,NY,NX)=SDPTHIs1(NZ)
    SCO2(NZ,NY,NX)=SCO2s1(NZ)
    SO2(NZ,NY,NX)=SO2s1(NZ)
    SSTX(NZ,NY,NX)=SSTXs1(NZ)
    SDVL(NZ,NY,NX)=SDVLs1(NZ)
    SDLG(NZ,NY,NX)=SDLGs1(NZ)
    SDAR(NZ,NY,NX)=SDARs1(NZ)
    SDPTH(NZ,NY,NX)=SDPTHs1(NZ)
    SFLXC(NZ,NY,NX)=SFLXCs1(NZ)
    TCO2T(NZ,NY,NX)=TCO2Ts1(NZ)
    TCO2A(NZ,NY,NX)=TCO2As1(NZ)
    TCSN0(NZ,NY,NX)=TCSN0s1(NZ)
    TZSN0(NZ,NY,NX)=TZSN0s1(NZ)
    TPSN0(NZ,NY,NX)=TPSN0s1(NZ)
    TCSNC(NZ,NY,NX)=TCSNCs1(NZ)
    TZSNC(NZ,NY,NX)=TZSNCs1(NZ)
    TPSNC(NZ,NY,NX)=TPSNCs1(NZ)
    TCZ(NZ,NY,NX)=TCZs1(NZ)
    TCX(NZ,NY,NX)=TCXs1(NZ)
    TNH3C(NZ,NY,NX)=TNH3Cs1(NZ)
    THVSTC(NZ,NY,NX)=THVSTCs1(NZ)
    THVSTN(NZ,NY,NX)=THVSTNs1(NZ)
    THVSTP(NZ,NY,NX)=THVSTPs1(NZ)
    TCUPTK(NZ,NY,NX)=TCUPTKs1(NZ)
    TZUPTK(NZ,NY,NX)=TZUPTKs1(NZ)
    TPUPTK(NZ,NY,NX)=TPUPTKs1(NZ)
    TZUPFX(NZ,NY,NX)=TZUPFXs1(NZ)
    TKC(NZ,NY,NX)=TKCs1(NZ)
    TCC(NZ,NY,NX)=TCCs1(NZ)
    THRM1(NZ,NY,NX)=THRM1s1(NZ)
    TKCZ(NZ,NY,NX)=TKCZs1(NZ)
    TKG(NZ,NY,NX)=TKGs1(NZ)
    TCG(NZ,NY,NX)=TCGs1(NZ)
    TFN3(NZ,NY,NX)=TFN3s1(NZ)
    UPNF(NZ,NY,NX)=UPNFs1(NZ)
    UPOMC(NZ,NY,NX)=UPOMCs1(NZ)
    UPOMN(NZ,NY,NX)=UPOMNs1(NZ)
    UPOMP(NZ,NY,NX)=UPOMPs1(NZ)
    UPNH4(NZ,NY,NX)=UPNH4s1(NZ)
    UPNO3(NZ,NY,NX)=UPNO3s1(NZ)
    UPH2P(NZ,NY,NX)=UPH2Ps1(NZ)
    UPH1P(NZ,NY,NX)=UPH1Ps1(NZ)
    VHCPC(NZ,NY,NX)=VHCPCs1(NZ)
    VOLWP(NZ,NY,NX)=VOLWPs1(NZ)
    VCO2F(NZ,NY,NX)=VCO2Fs1(NZ)
    VCH4F(NZ,NY,NX)=VCH4Fs1(NZ)
    VOXYF(NZ,NY,NX)=VOXYFs1(NZ)
    VNH3F(NZ,NY,NX)=VNH3Fs1(NZ)
    VN2OF(NZ,NY,NX)=VN2OFs1(NZ)
    VPO4F(NZ,NY,NX)=VPO4Fs1(NZ)
    VOLWC(NZ,NY,NX)=VOLWCs1(NZ)
    WSTR(NZ,NY,NX)=WSTRs1(NZ)
    WTSTG(NZ,NY,NX)=WTSTGs1(NZ)
    WTSTGN(NZ,NY,NX)=WTSTGNs1(NZ)
    WTSTGP(NZ,NY,NX)=WTSTGPs1(NZ)
    WTRVC(NZ,NY,NX)=WTRVCs1(NZ)
    WTRVN(NZ,NY,NX)=WTRVNs1(NZ)
    WTRVP(NZ,NY,NX)=WTRVPs1(NZ)
    WTRVX(NZ,NY,NX)=WTRVXs1(NZ)
    WTSHT(NZ,NY,NX)=WTSHTs1(NZ)
    WTSHN(NZ,NY,NX)=WTSHNs1(NZ)
    WTSHP(NZ,NY,NX)=WTSHPs1(NZ)
    WTLF(NZ,NY,NX)=WTLFs1(NZ)
    WTSHE(NZ,NY,NX)=WTSHEs1(NZ)
    WTSTK(NZ,NY,NX)=WTSTKs1(NZ)
    WVSTK(NZ,NY,NX)=WVSTKs1(NZ)
    WTRSV(NZ,NY,NX)=WTRSVs1(NZ)
    WTHSK(NZ,NY,NX)=WTHSKs1(NZ)
    WTEAR(NZ,NY,NX)=WTEARs1(NZ)
    WTGR(NZ,NY,NX)=WTGRs1(NZ)
    WTRT(NZ,NY,NX)=WTRTts1(NZ)
    WTRTS(NZ,NY,NX)=WTRTSs1(NZ)
    WTRTN(NZ,NY,NX)=WTRTNs1(NZ)
    WTRTP(NZ,NY,NX)=WTRTPs1(NZ)
    WTLFN(NZ,NY,NX)=WTLFNs1(NZ)
    WTSHEN(NZ,NY,NX)=WTSHENs1(NZ)
    WTSTKN(NZ,NY,NX)=WTSTKNs1(NZ)
    WTRSVN(NZ,NY,NX)=WTRSVNs1(NZ)
    WTHSKN(NZ,NY,NX)=WTHSKNs1(NZ)
    WTEARN(NZ,NY,NX)=WTEARNs1(NZ)
    WTGRNN(NZ,NY,NX)=WTGRNNs1(NZ)
    WTLFP(NZ,NY,NX)=WTLFPs1(NZ)
    WTSHEP(NZ,NY,NX)=WTSHEPs1(NZ)
    WTSTKP(NZ,NY,NX)=WTSTKPs1(NZ)
    WTRSVP(NZ,NY,NX)=WTRSVPs1(NZ)
    WTHSKP(NZ,NY,NX)=WTHSKPs1(NZ)
    WTEARP(NZ,NY,NX)=WTEARPs1(NZ)
    WTGRNP(NZ,NY,NX)=WTGRNPs1(NZ)
    WTND(NZ,NY,NX)=WTNDs1(NZ)
    WTNDN(NZ,NY,NX)=WTNDNs1(NZ)
    WTNDP(NZ,NY,NX)=WTNDPs1(NZ)
    WTLS(NZ,NY,NX)=WTLSs1(NZ)
    WTRTA(NZ,NY,NX)=WTRTAs1(NZ)
    XKCO2L(NZ,NY,NX)=XKCO2Ls1(NZ)
    XKCO2O(NZ,NY,NX)=XKCO2Os1(NZ)
    ZPOOLP(NZ,NY,NX)=ZPOOLPs1(NZ)
    ZPOLNP(NZ,NY,NX)=ZPOLNPs1(NZ)
    ZC(NZ,NY,NX)=ZCs1(NZ)
    ZNPP(NZ,NY,NX)=ZNPPs1(NZ)
    ZEROP(NZ,NY,NX)=ZEROPs1(NZ)
    ZEROQ(NZ,NY,NX)=ZEROQs1(NZ)
    ZEROL(NZ,NY,NX)=ZEROLs1(NZ)
    ZTYP(NZ,NY,NX)=ZTYPs1(NZ)
    HVST(NZ,I,NY,NX)=HVSTs1(NZ,I)
    IHVST(NZ,I,NY,NX)=IHVSTs1(NZ,I)
    JHVST(NZ,I,NY,NX)=JHVSTs1(NZ,I)
    THIN(NZ,I,NY,NX)=THINs1(NZ,I)
    DO L=1,JZ
      WTNDL(L,NZ,NY,NX)=WTNDLs1(L,NZ)
      WTNDLN(L,NZ,NY,NX)=WTNDLNs1(L,NZ)
      WTNDLP(L,NZ,NY,NX)=WTNDLPs1(L,NZ)
      CPOOLN(L,NZ,NY,NX)=CPOOLNs1(L,NZ)
      ZPOOLN(L,NZ,NY,NX)=ZPOOLNs1(L,NZ)
      PPOOLN(L,NZ,NY,NX)=PPOOLNs1(L,NZ)
      RUPNF(L,NZ,NY,NX)=RUPNFs1(L,NZ)
      TFN4(L,NZ,NY,NX)=TFN4s1(L,NZ)
    ENDDO
    DO L=1,JC
      ARLFV(L,NZ,NY,NX)=ARLFVs1(L,NZ)
      WGLFV(L,NZ,NY,NX)=WGLFVs1(L,NZ)
      ARSTV(L,NZ,NY,NX)=ARSTVs1(L,NZ)
    ENDDO
    DO L=0,JZ
      DO K=0,1
        DO M=1,4
          CSNC(M,K,L,NZ,NY,NX)=CSNCs1(M,K,L,NZ)
          PSNC(M,K,L,NZ,NY,NX)=PSNCs1(M,K,L,NZ)
          ZSNC(M,K,L,NZ,NY,NX)=ZSNCs1(M,K,L,NZ)
        ENDDO
      ENDDO
    ENDDO

    DO NB=1,NBR(NZ,NY,NX)
      DO L=1,JC
        ARSTK(L,NB,NZ,NY,NX)=ARSTKs1(L,NB,NZ)
      ENDDO
      ATRP(NB,NZ,NY,NX)=ATRPs1(NB,NZ)
      ARLFB(NB,NZ,NY,NX)=ARLFBs1(NB,NZ)
      ARLFZ(NB,NZ,NY,NX)=ARLFZs1(NB,NZ)
      CCPOLB(NB,NZ,NY,NX)=CCPOLBs1(NB,NZ)
      CZPOLB(NB,NZ,NY,NX)=CZPOLBs1(NB,NZ)
      CPPOLB(NB,NZ,NY,NX)=CPPOLBs1(NB,NZ)
      CPOLNB(NB,NZ,NY,NX)=CPOLNBs1(NB,NZ)
      CPOOL(NB,NZ,NY,NX)=CPOOLs1(NB,NZ)
      DGSTGI(NB,NZ,NY,NX)=DGSTGIs1(NB,NZ)
      DGSTGF(NB,NZ,NY,NX)=DGSTGFs1(NB,NZ)
      FLG4(NB,NZ,NY,NX)=FLG4s1(NB,NZ)
      FDBK(NB,NZ,NY,NX)=FDBKs1(NB,NZ)
      FDBKX(NB,NZ,NY,NX)=FDBKXs1(NB,NZ)
      FLGZ(NB,NZ,NY,NX)=FLGZs1(NB,NZ)
      GROUP(NB,NZ,NY,NX)=GROUPs1(NB,NZ)
      GSTGI(NB,NZ,NY,NX)=GSTGIs1(NB,NZ)
      GSTGF(NB,NZ,NY,NX)=GSTGFs1(NB,NZ)
      GRNXB(NB,NZ,NY,NX)=GRNXBs1(NB,NZ)
      GRNOB(NB,NZ,NY,NX)=GRNOBs1(NB,NZ)
      GRWTB(NB,NZ,NY,NX)=GRWTBs1(NB,NZ)
      HTSHEX(NB,NZ,NY,NX)=HTSHEXs1(NB,NZ)
      IFLGP(NB,NZ,NY,NX)=IFLGPs1(NB,NZ)
      IDTHB(NB,NZ,NY,NX)=IDTHBs1(NB,NZ)
      IFLGF(NB,NZ,NY,NX)=IFLGFs1(NB,NZ)
      IFLGE(NB,NZ,NY,NX)=IFLGEs1(NB,NZ)
      IFLGA(NB,NZ,NY,NX)=IFLGAs1(NB,NZ)
      IFLGG(NB,NZ,NY,NX)=IFLGGs1(NB,NZ)
      IFLGR(NB,NZ,NY,NX)=IFLGRs1(NB,NZ)
      IFLGQ(NB,NZ,NY,NX)=IFLGQs1(NB,NZ)
      KVSTG(NB,NZ,NY,NX)=KVSTGs1(NB,NZ)
      KLEAF(NB,NZ,NY,NX)=KLEAFs1(NB,NZ)
      KLEAFX(NB,NZ,NY,NX)=KLEAFXs1(NB,NZ)
      KVSTGN(NB,NZ,NY,NX)=KVSTGNs1(NB,NZ)
      NBTB(NB,NZ,NY,NX)=NBTBs1(NB,NZ)
      PSTG(NB,NZ,NY,NX)=PSTGs1(NB,NZ)
      PSTGI(NB,NZ,NY,NX)=PSTGIs1(NB,NZ)
      PSTGF(NB,NZ,NY,NX)=PSTGFs1(NB,NZ)
      PPOLNB(NB,NZ,NY,NX)=PPOLNBs1(NB,NZ)
      PPOOL(NB,NZ,NY,NX)=PPOOLs1(NB,NZ)
      RCCLX(NB,NZ,NY,NX)=RCCLXs1(NB,NZ)
      RCZLX(NB,NZ,NY,NX)=RCZLXs1(NB,NZ)
      RCPLX(NB,NZ,NY,NX)=RCPLXs1(NB,NZ)
      RCCSX(NB,NZ,NY,NX)=RCCSXs1(NB,NZ)
      RCZSX(NB,NZ,NY,NX)=RCZSXs1(NB,NZ)
      RCPSX(NB,NZ,NY,NX)=RCPSXs1(NB,NZ)
      RNH3B(NB,NZ,NY,NX)=RNH3Bs1(NB,NZ)
      TGSTGI(NB,NZ,NY,NX)=TGSTGIs1(NB,NZ)
      TGSTGF(NB,NZ,NY,NX)=TGSTGFs1(NB,NZ)
      VRNY(NB,NZ,NY,NX)=VRNYs1(NB,NZ)
      VRNZ(NB,NZ,NY,NX)=VRNZs1(NB,NZ)
      VRNS(NB,NZ,NY,NX)=VRNSs1(NB,NZ)
      VRNF(NB,NZ,NY,NX)=VRNFs1(NB,NZ)
      VSTG(NB,NZ,NY,NX)=VSTGs1(NB,NZ)
      VSTGX(NB,NZ,NY,NX)=VSTGXs1(NB,NZ)
      WTNDB(NB,NZ,NY,NX)=WTNDBs1(NB,NZ)
      WTNDBN(NB,NZ,NY,NX)=WTNDBNs1(NB,NZ)
      WTNDBP(NB,NZ,NY,NX)=WTNDBPs1(NB,NZ)
      WTLSB(NB,NZ,NY,NX)=WTLSBs1(NB,NZ)
      WTLFB(NB,NZ,NY,NX)=WTLFBs1(NB,NZ)
      WTSHEB(NB,NZ,NY,NX)=WTSHEBs1(NB,NZ)
      WTSTKB(NB,NZ,NY,NX)=WTSTKBs1(NB,NZ)
      WTRSVB(NB,NZ,NY,NX)=WTRSVBs1(NB,NZ)
      WTHSKB(NB,NZ,NY,NX)=WTHSKBs1(NB,NZ)
      WTEARB(NB,NZ,NY,NX)=WTEARBs1(NB,NZ)
      WTLFBN(NB,NZ,NY,NX)=WTLFBNs1(NB,NZ)
      WTSHBN(NB,NZ,NY,NX)=WTSHBNs1(NB,NZ)
      WTSTBN(NB,NZ,NY,NX)=WTSTBNs1(NB,NZ)
      WTRSBN(NB,NZ,NY,NX)=WTRSBNs1(NB,NZ)
      WTHSBN(NB,NZ,NY,NX)=WTHSBNs1(NB,NZ)
      WTEABN(NB,NZ,NY,NX)=WTEABNs1(NB,NZ)
      WTLFBP(NB,NZ,NY,NX)=WTLFBPs1(NB,NZ)
      WTSHBP(NB,NZ,NY,NX)=WTSHBPs1(NB,NZ)
      WTSTBP(NB,NZ,NY,NX)=WTSTBPs1(NB,NZ)
      WTRSBP(NB,NZ,NY,NX)=WTRSBPs1(NB,NZ)
      WTHSBP(NB,NZ,NY,NX)=WTHSBPs1(NB,NZ)
      WTEABP(NB,NZ,NY,NX)=WTEABPs1(NB,NZ)
      WGLFX(NB,NZ,NY,NX)=WGLFXs1(NB,NZ)
      WGLFNX(NB,NZ,NY,NX)=WGLFNXs1(NB,NZ)
      WGLFPX(NB,NZ,NY,NX)=WGLFPXs1(NB,NZ)
      WGSHEX(NB,NZ,NY,NX)=WGSHEXs1(NB,NZ)
      WGSHNX(NB,NZ,NY,NX)=WGSHNXs1(NB,NZ)
      WGSHPX(NB,NZ,NY,NX)=WGSHPXs1(NB,NZ)
      WTSTXB(NB,NZ,NY,NX)=WTSTXBs1(NB,NZ)
      WTSTXN(NB,NZ,NY,NX)=WTSTXNs1(NB,NZ)
      WTSTXP(NB,NZ,NY,NX)=WTSTXPs1(NB,NZ)
      WTSHTB(NB,NZ,NY,NX)=WTSHTBs1(NB,NZ)
      WTSHTN(NB,NZ,NY,NX)=WTSHTNs1(NB,NZ)
      WTSHTP(NB,NZ,NY,NX)=WTSHTPs1(NB,NZ)
      WVSTKB(NB,NZ,NY,NX)=WVSTKBs1(NB,NZ)
      WTGRB(NB,NZ,NY,NX)=WTGRBs1(NB,NZ)
      WTGRBN(NB,NZ,NY,NX)=WTGRBNs1(NB,NZ)
      WTGRBP(NB,NZ,NY,NX)=WTGRBPs1(NB,NZ)
      ZPOLNB(NB,NZ,NY,NX)=ZPOLNBs1(NB,NZ)
      ZPOOL(NB,NZ,NY,NX)=ZPOOLs1(NB,NZ)


      DO K=0,JNODS
        ARLF(K,NB,NZ,NY,NX)=ARLF1s1(K,NB,NZ)
        HTNODX(K,NB,NZ,NY,NX)=HTNODXs1(K,NB,NZ)
        HTNODE(K,NB,NZ,NY,NX)=HTNODEs1(K,NB,NZ)
        HTSHE(K,NB,NZ,NY,NX)=HTSHEs1(K,NB,NZ)
        WGNODE(K,NB,NZ,NY,NX)=WGNODEs1(K,NB,NZ)
        WGNODN(K,NB,NZ,NY,NX)=WGNODNs1(K,NB,NZ)
        WGNODP(K,NB,NZ,NY,NX)=WGNODPs1(K,NB,NZ)
        WGLF(K,NB,NZ,NY,NX)=WGLFs1(K,NB,NZ)
        WGLFN(K,NB,NZ,NY,NX)=WGLFNs1(K,NB,NZ)
        WGLFP(K,NB,NZ,NY,NX)=WGLFPs1(K,NB,NZ)
        WSLF(K,NB,NZ,NY,NX)=WSLFs1(K,NB,NZ)
        WGSHE(K,NB,NZ,NY,NX)=WGSHEs1(K,NB,NZ)
        WGSHN(K,NB,NZ,NY,NX)=WGSHNs1(K,NB,NZ)
        WGSHP(K,NB,NZ,NY,NX)=WGSHPs1(K,NB,NZ)
        WSSHE(K,NB,NZ,NY,NX)=WSSHEs1(K,NB,NZ)
      ENDDO
      DO  L=1,JC
        DO N=1,JLI
          SURFB(N,L,NB,NZ,NY,NX)=SURFBs1(N,L,NB,NZ)
        ENDDO
      ENDDO
      DO K=0,JNODS
        DO  L=1,JC
          ARLFL(L,K,NB,NZ,NY,NX)=ARLFLs1(L,K,NB,NZ)
          WGLFL(L,K,NB,NZ,NY,NX)=WGLFLs1(L,K,NB,NZ)
          WGLFLN(L,K,NB,NZ,NY,NX)=WGLFLNs1(L,K,NB,NZ)
          WGLFLP(L,K,NB,NZ,NY,NX)=WGLFLPs1(L,K,NB,NZ)
        ENDDO
      ENDDO
      DO M=1,10
        IDAY(M,NB,NZ,NY,NX)=IDAYs1(M,NB,NZ)
      ENDDO
      DO K=1,JNODS
        DO  L=1,JC
          DO N=1,JLI
            SURF(N,L,K,NB,NZ,NY,NX)=SURFs1(N,L,K,NB,NZ)
            SURFX(N,L,K,NB,NZ,NY,NX)=SURFXs1(N,L,K,NB,NZ)
          ENDDO
        ENDDO
        CPOOL3(K,NB,NZ,NY,NX)=CPOOL3s1(K,NB,NZ)
        CPOOL4(K,NB,NZ,NY,NX)=CPOOL4s1(K,NB,NZ)
        CO2B(K,NB,NZ,NY,NX)=CO2Bs1(K,NB,NZ)
        COMPL(K,NB,NZ,NY,NX)=COMPLs1(K,NB,NZ)
        CBXN(K,NB,NZ,NY,NX)=CBXNs1(K,NB,NZ)
        CBXN4(K,NB,NZ,NY,NX)=CBXN4s1(K,NB,NZ)
        ETGRO(K,NB,NZ,NY,NX)=ETGROs1(K,NB,NZ)
        ETGR4(K,NB,NZ,NY,NX)=ETGR4s1(K,NB,NZ)
        FDBK4(K,NB,NZ,NY,NX)=FDBK4s1(K,NB,NZ)
        HCOB(K,NB,NZ,NY,NX)=HCOBs1(K,NB,NZ)
        VCGRO(K,NB,NZ,NY,NX)=VCGROs1(K,NB,NZ)
        VGRO(K,NB,NZ,NY,NX)=VGROs1(K,NB,NZ)
        VCGR4(K,NB,NZ,NY,NX)=VCGR4s1(K,NB,NZ)
        VGRO4(K,NB,NZ,NY,NX)=VGRO4s1(K,NB,NZ)
      ENDDO
    ENDDO
    DO M=1,4
      WTSTDG(M,NZ,NY,NX)=WTSTDGs1(M,NZ)
      WTSTDN(M,NZ,NY,NX)=WTSTDNs1(M,NZ)
      WTSTDP(M,NZ,NY,NX)=WTSTDPs1(M,NZ)
    ENDDO

    DO  L=1,JZ
      DO N=1,2
        CCPOLR(N,L,NZ,NY,NX)=CCPOLRs1(N,L,NZ)
        CZPOLR(N,L,NZ,NY,NX)=CZPOLRs1(N,L,NZ)
        CPPOLR(N,L,NZ,NY,NX)=CPPOLRs1(N,L,NZ)
        CO2A(N,L,NZ,NY,NX)=CO2As1(N,L,NZ)
        CH4A(N,L,NZ,NY,NX)=CH4As1(N,L,NZ)
        CO2P(N,L,NZ,NY,NX)=CO2Ps1(N,L,NZ)
        CH4P(N,L,NZ,NY,NX)=CH4Ps1(N,L,NZ)
        CPOOLR(N,L,NZ,NY,NX)=CPOOLRs1(N,L,NZ)
        CWSRTL(N,L,NZ,NY,NX)=CWSRTLs1(N,L,NZ)
        H2GA(N,L,NZ,NY,NX)=H2GAs1(N,L,NZ)
        H2GP(N,L,NZ,NY,NX)=H2GPs1(N,L,NZ)
        OXYA(N,L,NZ,NY,NX)=OXYAs1(N,L,NZ)
        OXYP(N,L,NZ,NY,NX)=OXYPs1(N,L,NZ)
        PPOOLR(N,L,NZ,NY,NX)=PPOOLRs1(N,L,NZ)
        PSIRT(N,L,NZ,NY,NX)=PSIRTs1(N,L,NZ)
        PSIRO(N,L,NZ,NY,NX)=PSIROs1(N,L,NZ)
        PSIRG(N,L,NZ,NY,NX)=PSIRGs1(N,L,NZ)
        RTN1(N,L,NZ,NY,NX)=RTN1s1(N,L,NZ)
        RTNL(N,L,NZ,NY,NX)=RTNLs1(N,L,NZ)
        RTLGP(N,L,NZ,NY,NX)=RTLGPs1(N,L,NZ)
        RTDNP(N,L,NZ,NY,NX)=RTDNPs1(N,L,NZ)
        RTVLP(N,L,NZ,NY,NX)=RTVLPs1(N,L,NZ)
        RTVLW(N,L,NZ,NY,NX)=RTVLWs1(N,L,NZ)
        RRAD1(N,L,NZ,NY,NX)=RRAD1s1(N,L,NZ)
        RRAD2(N,L,NZ,NY,NX)=RRAD2s1(N,L,NZ)
        RTARP(N,L,NZ,NY,NX)=RTARPs1(N,L,NZ)
        RTLGA(N,L,NZ,NY,NX)=RTLGAs1(N,L,NZ)
        RCO2M(N,L,NZ,NY,NX)=RCO2Ms1(N,L,NZ)
        RCO2N(N,L,NZ,NY,NX)=RCO2Ns1(N,L,NZ)
        RCO2A(N,L,NZ,NY,NX)=RCO2As1(N,L,NZ)
        RCO2P(N,L,NZ,NY,NX)=RCO2Ps1(N,L,NZ)
        RUPOXP(N,L,NZ,NY,NX)=RUPOXPs1(N,L,NZ)
        RCO2S(N,L,NZ,NY,NX)=RCO2Ss1(N,L,NZ)
        RUPOXS(N,L,NZ,NY,NX)=RUPOXSs1(N,L,NZ)
        RUPCHS(N,L,NZ,NY,NX)=RUPCHSs1(N,L,NZ)
        RUPN2S(N,L,NZ,NY,NX)=RUPN2Ss1(N,L,NZ)
        RUPN3S(N,L,NZ,NY,NX)=RUPN3Ss1(N,L,NZ)
        RUPN3B(N,L,NZ,NY,NX)=RUPN3Bs1(N,L,NZ)
        RUPHGS(N,L,NZ,NY,NX)=RUPHGSs1(N,L,NZ)
        RCOFLA(N,L,NZ,NY,NX)=RCOFLAs1(N,L,NZ)
        ROXFLA(N,L,NZ,NY,NX)=ROXFLAs1(N,L,NZ)
        RCHFLA(N,L,NZ,NY,NX)=RCHFLAs1(N,L,NZ)
        RN2FLA(N,L,NZ,NY,NX)=RN2FLAs1(N,L,NZ)
        RNHFLA(N,L,NZ,NY,NX)=RNHFLAs1(N,L,NZ)
        RHGFLA(N,L,NZ,NY,NX)=RHGFLAs1(N,L,NZ)
        RCODFA(N,L,NZ,NY,NX)=RCODFAs1(N,L,NZ)
        ROXDFA(N,L,NZ,NY,NX)=ROXDFAs1(N,L,NZ)
        RCHDFA(N,L,NZ,NY,NX)=RCHDFAs1(N,L,NZ)
        RN2DFA(N,L,NZ,NY,NX)=RN2DFAs1(N,L,NZ)
        RNHDFA(N,L,NZ,NY,NX)=RNHDFAs1(N,L,NZ)
        RHGDFA(N,L,NZ,NY,NX)=RHGDFAs1(N,L,NZ)
        RUNNHP(N,L,NZ,NY,NX)=RUNNHPs1(N,L,NZ)
        RUPNH4(N,L,NZ,NY,NX)=RUPNH4s1(N,L,NZ)
        RUONH4(N,L,NZ,NY,NX)=RUONH4s1(N,L,NZ)
        RUCNH4(N,L,NZ,NY,NX)=RUCNH4s1(N,L,NZ)
        RUNNBP(N,L,NZ,NY,NX)=RUNNBPs1(N,L,NZ)
        RUPNHB(N,L,NZ,NY,NX)=RUPNHBs1(N,L,NZ)
        RUONHB(N,L,NZ,NY,NX)=RUONHBs1(N,L,NZ)
        RUCNHB(N,L,NZ,NY,NX)=RUCNHBs1(N,L,NZ)
        RUNNOP(N,L,NZ,NY,NX)=RUNNOPs1(N,L,NZ)
        RUPNO3(N,L,NZ,NY,NX)=RUPNO3s1(N,L,NZ)
        RUONO3(N,L,NZ,NY,NX)=RUONO3s1(N,L,NZ)
        RUCNO3(N,L,NZ,NY,NX)=RUCNO3s1(N,L,NZ)
        RUNNXP(N,L,NZ,NY,NX)=RUNNXPs1(N,L,NZ)
        RUPNOB(N,L,NZ,NY,NX)=RUPNOBs1(N,L,NZ)
        RUONOB(N,L,NZ,NY,NX)=RUONOBs1(N,L,NZ)
        RUCNOB(N,L,NZ,NY,NX)=RUCNOBs1(N,L,NZ)
        RUPP2P(N,L,NZ,NY,NX)=RUPP2Ps1(N,L,NZ)
        RUPH2P(N,L,NZ,NY,NX)=RUPH2Ps1(N,L,NZ)
        RUOH2P(N,L,NZ,NY,NX)=RUOH2Ps1(N,L,NZ)
        RUCH2P(N,L,NZ,NY,NX)=RUCH2Ps1(N,L,NZ)
        RUPP2B(N,L,NZ,NY,NX)=RUPP2Bs1(N,L,NZ)
        RUPH2B(N,L,NZ,NY,NX)=RUPH2Bs1(N,L,NZ)
        RUOH2B(N,L,NZ,NY,NX)=RUOH2Bs1(N,L,NZ)
        RUCH2B(N,L,NZ,NY,NX)=RUCH2Bs1(N,L,NZ)
        RUPP1P(N,L,NZ,NY,NX)=RUPP1Ps1(N,L,NZ)
        RUPH1P(N,L,NZ,NY,NX)=RUPH1Ps1(N,L,NZ)
        RUOH1P(N,L,NZ,NY,NX)=RUOH1Ps1(N,L,NZ)
        RUCH1P(N,L,NZ,NY,NX)=RUCH1Ps1(N,L,NZ)
        RUPP1B(N,L,NZ,NY,NX)=RUPP1Bs1(N,L,NZ)
        RUPH1B(N,L,NZ,NY,NX)=RUPH1Bs1(N,L,NZ)
        RUOH1B(N,L,NZ,NY,NX)=RUOH1Bs1(N,L,NZ)
        RUCH1B(N,L,NZ,NY,NX)=RUCH1Bs1(N,L,NZ)
        ROXYP(N,L,NZ,NY,NX)=ROXYPs1(N,L,NZ)
        UPWTR(N,L,NZ,NY,NX)=UPWTRs1(N,L,NZ)
        WTRTL(N,L,NZ,NY,NX)=WTRTLs1(N,L,NZ)
        WTRTD(N,L,NZ,NY,NX)=WTRTDs1(N,L,NZ)
        WSRTL(N,L,NZ,NY,NX)=WSRTLs1(N,L,NZ)
        WFR(N,L,NZ,NY,NX)=WFRs1(N,L,NZ)
        Z2OA(N,L,NZ,NY,NX)=Z2OAs1(N,L,NZ)
        ZH3A(N,L,NZ,NY,NX)=ZH3As1(N,L,NZ)
        Z2OP(N,L,NZ,NY,NX)=Z2OPs1(N,L,NZ)
        ZH3P(N,L,NZ,NY,NX)=ZH3Ps1(N,L,NZ)
        ZPOOLR(N,L,NZ,NY,NX)=ZPOOLRs1(N,L,NZ)
      ENDDO
    ENDDO

    DO NR=1,NRT(NZ,NY,NX)
      NINR(NR,NZ,NY,NX)=NINRs1(NR,NZ)
      DO N=1,2
        RTWT1(N,NR,NZ,NY,NX)=RTWT1s1(N,NR,NZ)
        RTWT1N(N,NR,NZ,NY,NX)=RTWT1Ns1(N,NR,NZ)
        RTWT1P(N,NR,NZ,NY,NX)=RTWT1Ps1(N,NR,NZ)
        RTDP1(N,NR,NZ,NY,NX)=RTDP1s1(N,NR,NZ)
      ENDDO
      DO L=1,JZ
        DO N=1,2
          WTRT1(N,L,NR,NZ,NY,NX)=WTRT1s1(N,L,NR,NZ)
          WTRT1N(N,L,NR,NZ,NY,NX)=WTRT1Ns1(N,L,NR,NZ)
          WTRT1P(N,L,NR,NZ,NY,NX)=WTRT1Ps1(N,L,NR,NZ)
          WTRT2(N,L,NR,NZ,NY,NX)=WTRT2s1(N,L,NR,NZ)
          WTRT2N(N,L,NR,NZ,NY,NX)=WTRT2Ns1(N,L,NR,NZ)
          WTRT2P(N,L,NR,NZ,NY,NX)=WTRT2Ps1(N,L,NR,NZ)
          RTLG1(N,L,NR,NZ,NY,NX)=RTLG1s1(N,L,NR,NZ)
          RTLG2(N,L,NR,NZ,NY,NX)=RTLG2s1(N,L,NR,NZ)
          RTN2(N,L,NR,NZ,NY,NX)=RTN2s1(N,L,NR,NZ)
        ENDDO
      ENDDO
    ENDDO

    EHVST(1:2,1:4,NZ,I,NY,NX)=EHVSTs1(1:2,1:4,NZ,I)


    DO L=NU(NY,NX),NI(NZ,NY,NX)
      DO K=0,jcplx1
        DO N=1,2
          RDFOMC(N,K,L,NZ,NY,NX)=RDFOMCs1(N,K,L,NZ)
          RDFOMN(N,K,L,NZ,NY,NX)=RDFOMNs1(N,K,L,NZ)
          RDFOMP(N,K,L,NZ,NY,NX)=RDFOMPs1(N,K,L,NZ)
        ENDDO
      ENDDO
    ENDDO

    DO M=1,4
      DO N=0,5
        CFOPC(N,M,NZ,NY,NX)=CFOPCs1(N,M,NZ)
        CFOPN(N,M,NZ,NY,NX)=CFOPNs1(N,M,NZ)
        CFOPP(N,M,NZ,NY,NX)=CFOPPs1(N,M,NZ)
      enddo
    enddo
    RRAD1M(2,NZ,NY,NX)=RRAD1Ms1(2,NZ)
    RRAD2M(2,NZ,NY,NX)=RRAD2Ms1(2,NZ)
    PORT(2,NZ,NY,NX)=PORTs1(2,NZ)
    UPMXZH(2,NZ,NY,NX)=UPMXZHs1(2,NZ)
    UPKMZH(2,NZ,NY,NX)=UPKMZHs1(2,NZ)
    UPMNZH(2,NZ,NY,NX)=UPMNZHs1(2,NZ)
    UPMXZO(2,NZ,NY,NX)=UPMXZOs1(2,NZ)
    UPKMZO(2,NZ,NY,NX)=UPKMZOs1(2,NZ)
    UPMNZO(2,NZ,NY,NX)=UPMNZOs1(2,NZ)
    UPMXPO(2,NZ,NY,NX)=UPMXPOs1(2,NZ)
    UPKMPO(2,NZ,NY,NX)=UPKMPOs1(2,NZ)
    UPMNPO(2,NZ,NY,NX)=UPMNPOs1(2,NZ)
    RSRR(2,NZ,NY,NX)=RSRRs1(2,NZ)
    RSRA(2,NZ,NY,NX)=RSRAs1(2,NZ)
    DO N=1,2
      PORTX(N,NZ,NY,NX)=PORTXs1(N,NZ)
      RRADP(N,NZ,NY,NX)=RRADPs1(N,NZ)
      DMVL(N,NZ,NY,NX)=DMVLs1(N,NZ)
      RTLG1X(N,NZ,NY,NX)=RTLG1Xs1(N,NZ)
      RTLG2X(N,NZ,NY,NX)=RTLG2Xs1(N,NZ)
      RRAD1X(N,NZ,NY,NX)=RRAD1Xs1(N,NZ)
      RRAD2X(N,NZ,NY,NX)=RRAD2Xs1(N,NZ)
      RTAR1X(N,NZ,NY,NX)=RTAR1Xs1(N,NZ)
      RTAR2X(N,NZ,NY,NX)=RTAR2Xs1(N,NZ)
    enDDO
  ENDDO

  end subroutine PlantAPIRecv



!------------------------------------------------------------------------------------------

  subroutine PlantAPISend(I,J,NY,NX)
  implicit none
  integer, intent(in) :: I,J,NY,NX
  integer :: K,L,M,N,NB,NZ,NR,I1

  I1=I+1;if(I1>366)I1=1
  ZEROs1=ZERO
  ALATs1=ALAT(NY,NX)
  ATCAs1=ATCA(NY,NX)
  ARLSSs1=ARLSS(NY,NX)
  ARLFCs1=ARLFC(NY,NX)
  ALTs1=ALT(NY,NX)
  CCO2EIs1=CCO2EI(NY,NX)
  CO2EIs1=CO2EI(NY,NX)
  COXYEs1=COXYE(NY,NX)
  CNETXs1=CNETX(NY,NX)
  CO2Es1=CO2E(NY,NX)
  CCO2Es1=CCO2E(NY,NX)
  CCH4Es1=CCH4E(NY,NX)
  CZ2OEs1=CZ2OE(NY,NX)
  CH2GEs1=CH2GE(NY,NX)
  CNH3Es1=CNH3E(NY,NX)
  DYLXs1=DYLX(NY,NX)
  DYLNs1=DYLN(NY,NX)
  DPTHSs1=DPTHS(NY,NX)
  DYLMs1=DYLM(NY,NX)
  IYTYPs1=IYTYP(2,I1,NY,NX)
  IETYPs1=IETYP(NY,NX)
  IFLGTs1=IFLGT(NY,NX)
  IYRCs1=IYRC
  IGOs1=IGO
  NLs1=NL(NY,NX)
  NP0s1=NP0(NY,NX)
  NJs1=NJ(NY,NX)
  NPs1=NP(NY,NX)
  NUs1=NU(NY,NX)
  OXYEs1=OXYE(NY,NX)
  PPTs1=PPT(NY,NX)
  RABs1=RAB(NY,NX)
  RIBs1=RIB(NY,NX)
  RECOs1=RECO(NY,NX)
  SSINNs1=SSINN(NY,NX)
  SSINs1=SSIN(NY,NX)
  TKWs1=TKW(1,NY,NX)
  TNBPs1=TNBP(NY,NX)
  TGPPs1=TGPP(NY,NX)
  TKAs1=TKA(NY,NX)
  TLECs1=TLEC(NY,NX)
  TSHCs1=TSHC(NY,NX)
  THRMGXs1=THRMGX(NY,NX)
  THSs1=THS(NY,NX)
  TRAUs1=TRAU(NY,NX)
  UVOLOs1=UVOLO(NY,NX)
  VPAs1=VPA(NY,NX)
  XHVSTCs1=XHVSTC(NY,NX)
  XHVSTNs1=XHVSTN(NY,NX)
  XHVSTPs1=XHVSTP(NY,NX)
  XCORPs1=XCORP(NY,NX)
  ZNOONs1=ZNOON(NY,NX)
  ZEROS2s1=ZEROS2(NY,NX)
  ZEROSs1=ZEROS(NY,NX)
  ZRs1=ZR(NY,NX)
  ZTs1=ZT(NY,NX)
  ZDs1=ZD(NY,NX)
  AREA3Us1=AREA(3,NU(NY,NX),NY,NX)
  IDATAs1(:)=IDATA(:)

  DCORPs1(I)=DCORP(I,NY,NX)
  FERTs1(1:20,I1)=FERT(1:20,I1,NY,NX)
  ITILLs1(I)=ITILL(I,NY,NX)

  DO L=0,JC
    ZLs1(L)=ZL(L,NY,NX)
  ENDDO
  DO  L=1,JC
    ARLFTs1(L)=ARLFT(L,NY,NX)
    TAUSs1(L)=TAUS(L,NY,NX)
    TAU0s1(L)=TAU0(L,NY,NX)
  ENDDO
  DO L=1,NL(NY,NX)
    CPO4Ss1(L)=CPO4S(L,NY,NX)
    CNDUs1(L)=CNDU(L,NY,NX)
    CGSGLs1(L)=CGSGL(L,NY,NX)
    CHSGLs1(L)=CHSGL(L,NY,NX)
    HGSGLs1(L)=HGSGL(L,NY,NX)
    OGSGLs1(L)=OGSGL(L,NY,NX)
    RSCSs1(L)=RSCS(L,NY,NX)
    Z2SGLs1(L)=Z2SGL(L,NY,NX)
    ZHSGLs1(L)=ZHSGL(L,NY,NX)
    DPTHZs1(L)=DPTHZ(L,NY,NX)
  ENDDo
  DO L=1,NL(NY,NX)
    CO2Gs1(L)=CO2G(L,NY,NX)
    OXYGs1(L)=OXYG(L,NY,NX)
  ENDDO
  DO L=0,NL(NY,NX)
    BKDSs1(L)=BKDS(L,NY,NX)
    CH2P4s1(L)=CH2P4(L,NY,NX)
    CH1P4Bs1(L)=CH1P4B(L,NY,NX)
    CH2P4Bs1(L)=CH2P4B(L,NY,NX)
    CNO3Ss1(L)=CNO3S(L,NY,NX)
    CH1P4s1(L)=CH1P4(L,NY,NX)
    COXYGs1(L)=COXYG(L,NY,NX)
    COXYSs1(L)=COXYS(L,NY,NX)
    CNO3Bs1(L)=CNO3B(L,NY,NX)
    CNH4Ss1(L)=CNH4S(L,NY,NX)
    CNH4Bs1(L)=CNH4B(L,NY,NX)
    CO2Ss1(L)=CO2S(L,NY,NX)
    CH4Ss1(L)=CH4S(L,NY,NX)
    CCH4Ss1(L)=CCH4S(L,NY,NX)
    CZ2OSs1(L)=CZ2OS(L,NY,NX)
    CNH3Ss1(L)=CNH3S(L,NY,NX)
    CNH3Bs1(L)=CNH3B(L,NY,NX)
    CH2GSs1(L)=CH2GS(L,NY,NX)
    CLSGLs1(L)=CLSGL(L,NY,NX)
    CQSGLs1(L)=CQSGL(L,NY,NX)
    CCH4Gs1(L)=CCH4G(L,NY,NX)
    CZ2OGs1(L)=CZ2OG(L,NY,NX)
    CNH3Gs1(L)=CNH3G(L,NY,NX)
    CH2GGs1(L)=CH2GG(L,NY,NX)
    CORGCs1(L)=CORGC(L,NY,NX)
    CDPTHZs1(L)=CDPTHZ(L,NY,NX)
    FMPRs1(L)=FMPR(L,NY,NX)
    H1PO4s1(L)=H1PO4(L,NY,NX)
    H2PO4s1(L)=H2PO4(L,NY,NX)
    H1POBs1(L)=H1POB(L,NY,NX)
    H2POBs1(L)=H2POB(L,NY,NX)
    H2GSs1(L)=H2GS(L,NY,NX)
    HLSGLs1(L)=HLSGL(L,NY,NX)
    OXYSs1(L)=OXYS(L,NY,NX)
    OLSGLs1(L)=OLSGL(L,NY,NX)
    POSGLs1(L)=POSGL(L,NY,NX)
    PSISTs1(L)=PSIST(L,NY,NX)
    RPO4Ys1(L)=RPO4Y(L,NY,NX)
    RPOBYs1(L)=RPOBY(L,NY,NX)
    RP14Ys1(L)=RP14Y(L,NY,NX)
    RP1BYs1(L)=RP1BY(L,NY,NX)
    RNO3Ys1(L)=RNO3Y(L,NY,NX)
    RNH4Ys1(L)=RNH4Y(L,NY,NX)
    RNHBYs1(L)=RNHBY(L,NY,NX)
    RN3BYs1(L)=RN3BY(L,NY,NX)
    ROXYFs1(L)=ROXYF(L,NY,NX)
    RCO2Fs1(L)=RCO2F(L,NY,NX)
    ROXYLs1(L)=ROXYL(L,NY,NX)
    ROXYYs1(L)=ROXYY(L,NY,NX)
    SCO2Ls1(L)=SCO2L(L,NY,NX)
    SOXYLs1(L)=SOXYL(L,NY,NX)
    SCH4Ls1(L)=SCH4L(L,NY,NX)
    SN2OLs1(L)=SN2OL(L,NY,NX)
    SNH3Ls1(L)=SNH3L(L,NY,NX)
    SH2GLs1(L)=SH2GL(L,NY,NX)
    THETWs1(L)=THETW(L,NY,NX)
    THETYs1(L)=THETY(L,NY,NX)
    TKSs1(L)=TKS(L,NY,NX)
    TFNDs1(L)=TFND(L,NY,NX)
    VOLXs1(L)=VOLX(L,NY,NX)
    VLPOBs1(L)=VLPOB(L,NY,NX)
    VLNO3s1(L)=VLNO3(L,NY,NX)
    VLPO4s1(L)=VLPO4(L,NY,NX)
    VOLYs1(L)=VOLY(L,NY,NX)
    VOLIs1(L)=VOLI(L,NY,NX)
    VOLWs1(L)=VOLW(L,NY,NX)
    VOLAs1(L)=VOLA(L,NY,NX)
    VLNOBs1(L)=VLNOB(L,NY,NX)
    VLNH4s1(L)=VLNH4(L,NY,NX)
    VLNHBs1(L)=VLNHB(L,NY,NX)
    ZOSGLs1(L)=ZOSGL(L,NY,NX)
    ZNO3Ss1(L)=ZNO3S(L,NY,NX)
    ZNO3Bs1(L)=ZNO3B(L,NY,NX)
    ZNSGLs1(L)=ZNSGL(L,NY,NX)
    ZNH4Ss1(L)=ZNH4S(L,NY,NX)
    ZNH4Bs1(L)=ZNH4B(L,NY,NX)
    Z2OSs1(L)=Z2OS(L,NY,NX)
    ZNH3Ss1(L)=ZNH3S(L,NY,NX)
    ZNH3Bs1(L)=ZNH3B(L,NY,NX)
    ZVSGLs1(L)=ZVSGL(L,NY,NX)

    DO K=0,jcplx1
      FOSRHs1(K,L)=FOSRH(K,L,NY,NX)
      OQCs1(K,L)=OQC(K,L,NY,NX)
      OQNs1(K,L)=OQN(K,L,NY,NX)
      OQPs1(K,L)=OQP(K,L,NY,NX)
      XOQCSs1(K,L)=XOQCS(K,L,NY,NX)
      XOQNSs1(K,L)=XOQNS(K,L,NY,NX)
      XOQPSs1(K,L)=XOQPS(K,L,NY,NX)
    ENDDO
  ENDDO

  DO NZ=1,NP0(NY,NX)
    EHVSTs1(1:2,1:4,NZ,I)=EHVST(1:2,1:4,NZ,I,NY,NX)
    FLWCs1(NZ)=FLWC(NZ,NY,NX)
    IDTHs1(NZ)=IDTH(NZ,NY,NX)
    IYR0s1(NZ)=IYR0(NZ,NY,NX)
    NNODs1(NZ)=NNOD(NZ,NY,NX)
    IBTYPs1(NZ)=IBTYP(NZ,NY,NX)
    IDTHPs1(NZ)=IDTHP(NZ,NY,NX)
    IDTHRs1(NZ)=IDTHR(NZ,NY,NX)
    IWTYPs1(NZ)=IWTYP(NZ,NY,NX)
    IPTYPs1(NZ)=IPTYP(NZ,NY,NX)
    ZEROQs1(NZ)=ZEROQ(NZ,NY,NX)
    IYRXs1(NZ)=IYRX(NZ,NY,NX)
    IDAYXs1(NZ)=IDAYX(NZ,NY,NX)
    IDTYPs1(NZ)=IDTYP(NZ,NY,NX)
    SSTXs1(NZ)=SSTX(NZ,NY,NX)
    ZTYPIs1(NZ)=ZTYPI(NZ,NY,NX)
    FRADPs1(NZ)=FRADP(NZ,NY,NX)
    CNSTKs1(NZ)=CNSTK(NZ,NY,NX)
    CPSTKs1(NZ)=CPSTK(NZ,NY,NX)
    RNH3Cs1(NZ)=RNH3C(NZ,NY,NX)
    DTKCs1(NZ)=DTKC(NZ,NY,NX)
    ZTYPs1(NZ)=ZTYP(NZ,NY,NX)
    IYRYs1(NZ)=IYRY(NZ,NY,NX)
    RSMXs1(NZ)=RSMX(NZ,NY,NX)
    WTHSKPs1(NZ)=WTHSKP(NZ,NY,NX)
    WTRSVPs1(NZ)=WTRSVP(NZ,NY,NX)
    HTCs1(NZ)=HTC(NZ,NY,NX)
    GRDMs1(NZ)=GRDM(NZ,NY,NX)
    WTLFs1(NZ)=WTLF(NZ,NY,NX)
    EPs1(NZ)=EP(NZ,NY,NX)
    WTEARNs1(NZ)=WTEARN(NZ,NY,NX)
    WTEARs1(NZ)=WTEAR(NZ,NY,NX)
    WTGRNPs1(NZ)=WTGRNP(NZ,NY,NX)
    WTSTKPs1(NZ)=WTSTKP(NZ,NY,NX)
    WTSHEPs1(NZ)=WTSHEP(NZ,NY,NX)
    WTHSKNs1(NZ)=WTHSKN(NZ,NY,NX)
    WTRSVNs1(NZ)=WTRSVN(NZ,NY,NX)
    WTSTKNs1(NZ)=WTSTKN(NZ,NY,NX)
    WTLFNs1(NZ)=WTLFN(NZ,NY,NX)
    WTRTSs1(NZ)=WTRTS(NZ,NY,NX)
    WTHSKs1(NZ)=WTHSK(NZ,NY,NX)
    WTRSVs1(NZ)=WTRSV(NZ,NY,NX)
    WVSTKs1(NZ)=WVSTK(NZ,NY,NX)
    WTSTKs1(NZ)=WTSTK(NZ,NY,NX)
    CHILLs1(NZ)=CHILL(NZ,NY,NX)
    WTSHEs1(NZ)=WTSHE(NZ,NY,NX)
    PSILOs1(NZ)=PSILO(NZ,NY,NX)
    INTYPs1(NZ)=INTYP(NZ,NY,NX)
    WTSHENs1(NZ)=WTSHEN(NZ,NY,NX)
    OSMOs1(NZ)=OSMO(NZ,NY,NX)
    WTGRs1(NZ)=WTGR(NZ,NY,NX)
    WTEARPs1(NZ)=WTEARP(NZ,NY,NX)
    WTLFPs1(NZ)=WTLFP(NZ,NY,NX)
    TCCs1(NZ)=TCC(NZ,NY,NX)
    CWSRTs1(NZ)=CWSRT(NZ,NY,NX)
    WTGRNNs1(NZ)=WTGRNN(NZ,NY,NX)
    RSMHs1(NZ)=RSMH(NZ,NY,NX)
    ICTYPs1(NZ)=ICTYP(NZ,NY,NX)
    WTRTAs1(NZ)=WTRTA(NZ,NY,NX)
    CFs1(NZ)=CF(NZ,NY,NX)
    CFIs1(NZ)=CFI(NZ,NY,NX)
    PPIs1(NZ)=PPI(NZ,NY,NX)
    PPXs1(NZ)=PPX(NZ,NY,NX)
    PPZs1(NZ)=PPZ(NZ,NY,NX)
    IDAYYs1(NZ)=IDAYY(NZ,NY,NX)
    VOXYFs1(NZ)=VOXYF(NZ,NY,NX)
    ENGYXs1(NZ)=ENGYX(NZ,NY,NX)
    TCO2As1(NZ)=TCO2A(NZ,NY,NX)
    CTRANs1(NZ)=CTRAN(NZ,NY,NX)
    WTSTDIs1(NZ)=WTSTDI(NZ,NY,NX)
    MYs1(NZ)=MY(NZ,NY,NX)
    NBTs1(NZ)=NBT(NZ,NY,NX)
    NGs1(NZ)=NG(NZ,NY,NX)
    IFLGIs1(NZ)=IFLGI(NZ,NY,NX)
    NIXs1(NZ)=NIX(NZ,NY,NX)
    NRTs1(NZ)=NRT(NZ,NY,NX)
    NB1s1(NZ)=NB1(NZ,NY,NX)
    NBRs1(NZ)=NBR(NZ,NY,NX)
    IGTYPs1(NZ)=IGTYP(NZ,NY,NX)
    CPGRs1(NZ)=CPGR(NZ,NY,NX)
    CNGRs1(NZ)=CNGR(NZ,NY,NX)
    IFLGCs1(NZ)=IFLGC(NZ,NY,NX)
    IDAY0s1(NZ)=IDAY0(NZ,NY,NX)
    IDAYHs1(NZ)=IDAYH(NZ,NY,NX)
    IYRHs1(NZ)=IYRH(NZ,NY,NX)
    ISTYPs1(NZ)=ISTYP(NZ,NY,NX)
    HVSTs1(NZ,I)=HVST(NZ,I,NY,NX)
    IHVSTs1(NZ,I)=IHVST(NZ,I,NY,NX)
    JHVSTs1(NZ,I)=JHVST(NZ,I,NY,NX)
    THINs1(NZ,I)=THIN(NZ,I,NY,NX)
    ARSTPs1(NZ)=ARSTP(NZ,NY,NX)
    ARLFPs1(NZ)=ARLFP(NZ,NY,NX)
    BALCs1(NZ)=BALC(NZ,NY,NX)
    BALNs1(NZ)=BALN(NZ,NY,NX)
    BALPs1(NZ)=BALP(NZ,NY,NX)
    CO2Is1(NZ)=CO2I(NZ,NY,NX)
    CCPOLPs1(NZ)=CCPOLP(NZ,NY,NX)
    CPOOLPs1(NZ)=CPOOLP(NZ,NY,NX)
    CPOLNPs1(NZ)=CPOLNP(NZ,NY,NX)
    CCPLNPs1(NZ)=CCPLNP(NZ,NY,NX)
    CZPOLPs1(NZ)=CZPOLP(NZ,NY,NX)
    CPPOLPs1(NZ)=CPPOLP(NZ,NY,NX)
    CTCs1(NZ)=CTC(NZ,NY,NX)
    CNETs1(NZ)=CNET(NZ,NY,NX)
    CARBNs1(NZ)=CARBN(NZ,NY,NX)
    CNNDs1(NZ)=CNND(NZ,NY,NX)
    CPNDs1(NZ)=CPND(NZ,NY,NX)
    CNRTSs1(NZ)=CNRTS(NZ,NY,NX)
    CPRTSs1(NZ)=CPRTS(NZ,NY,NX)
    CNRTs1(NZ)=CNRT(NZ,NY,NX)
    CPRTs1(NZ)=CPRT(NZ,NY,NX)
    CNWSs1(NZ)=CNWS(NZ,NY,NX)
    CPWSs1(NZ)=CPWS(NZ,NY,NX)
    CFXs1(NZ)=CFX(NZ,NY,NX)
    DCO2s1(NZ)=DCO2(NZ,NY,NX)
    DATAPs1(NZ)=DATAP(NZ,NY,NX)
    DMNDs1(NZ)=DMND(NZ,NY,NX)
    DMRTs1(NZ)=DMRT(NZ,NY,NX)
    FMOLs1(NZ)=FMOL(NZ,NY,NX)
    FNODs1(NZ)=FNOD(NZ,NY,NX)
    GROUPIs1(NZ)=GROUPI(NZ,NY,NX)
    HTCTLs1(NZ)=HTCTL(NZ,NY,NX)
    HCSNCs1(NZ)=HCSNC(NZ,NY,NX)
    HZSNCs1(NZ)=HZSNC(NZ,NY,NX)
    HPSNCs1(NZ)=HPSNC(NZ,NY,NX)
    HVSTCs1(NZ)=HVSTC(NZ,NY,NX)
    HVSTNs1(NZ)=HVSTN(NZ,NY,NX)
    HVSTPs1(NZ)=HVSTP(NZ,NY,NX)
    HCUPTKs1(NZ)=HCUPTK(NZ,NY,NX)
    HZUPTKs1(NZ)=HZUPTK(NZ,NY,NX)
    HPUPTKs1(NZ)=HPUPTK(NZ,NY,NX)
    HTSTZs1(NZ)=HTSTZ(NZ,NY,NX)
    OFFSTs1(NZ)=OFFST(NZ,NY,NX)
    OSTRs1(NZ)=OSTR(NZ,NY,NX)
    PPs1(NZ)=PP(NZ,NY,NX)
    PSILTs1(NZ)=PSILT(NZ,NY,NX)
    PBs1(NZ)=PB(NZ,NY,NX)
    PRs1(NZ)=PR(NZ,NY,NX)
    PPOOLPs1(NZ)=PPOOLP(NZ,NY,NX)
    PPOLNPs1(NZ)=PPOLNP(NZ,NY,NX)
    PSILGs1(NZ)=PSILG(NZ,NY,NX)
    RCMXs1(NZ)=RCMX(NZ,NY,NX)
    RCO2Zs1(NZ)=RCO2Z(NZ,NY,NX)
    ROXYZs1(NZ)=ROXYZ(NZ,NY,NX)
    RCH4Zs1(NZ)=RCH4Z(NZ,NY,NX)
    RN2OZs1(NZ)=RN2OZ(NZ,NY,NX)
    RNH3Zs1(NZ)=RNH3Z(NZ,NY,NX)
    RH2GZs1(NZ)=RH2GZ(NZ,NY,NX)
    RSETCs1(NZ)=RSETC(NZ,NY,NX)
    RSETNs1(NZ)=RSETN(NZ,NY,NX)
    RSETPs1(NZ)=RSETP(NZ,NY,NX)
    RTFQs1(NZ)=RTFQ(NZ,NY,NX)
    RAZs1(NZ)=RAZ(NZ,NY,NX)
    SCO2s1(NZ)=SCO2(NZ,NY,NX)
    SDPTHs1(NZ)=SDPTH(NZ,NY,NX)
    SDPTHIs1(NZ)=SDPTHI(NZ,NY,NX)
    SDLGs1(NZ)=SDLG(NZ,NY,NX)
    SDVLs1(NZ)=SDVL(NZ,NY,NX)
    SDARs1(NZ)=SDAR(NZ,NY,NX)
    TCZs1(NZ)=TCZ(NZ,NY,NX)
    TCGs1(NZ)=TCG(NZ,NY,NX)
    TCXs1(NZ)=TCX(NZ,NY,NX)
    TKGs1(NZ)=TKG(NZ,NY,NX)
    TFN3s1(NZ)=TFN3(NZ,NY,NX)
    TCSN0s1(NZ)=TCSN0(NZ,NY,NX)
    TZSN0s1(NZ)=TZSN0(NZ,NY,NX)
    TPSN0s1(NZ)=TPSN0(NZ,NY,NX)
    TCSNCs1(NZ)=TCSNC(NZ,NY,NX)
    TZSNCs1(NZ)=TZSNC(NZ,NY,NX)
    TPSNCs1(NZ)=TPSNC(NZ,NY,NX)
    TCO2Ts1(NZ)=TCO2T(NZ,NY,NX)
    TCUPTKs1(NZ)=TCUPTK(NZ,NY,NX)
    THVSTCs1(NZ)=THVSTC(NZ,NY,NX)
    TNH3Cs1(NZ)=TNH3C(NZ,NY,NX)
    TZUPTKs1(NZ)=TZUPTK(NZ,NY,NX)
    THVSTNs1(NZ)=THVSTN(NZ,NY,NX)
    TZUPFXs1(NZ)=TZUPFX(NZ,NY,NX)
    TPUPTKs1(NZ)=TPUPTK(NZ,NY,NX)
    THVSTPs1(NZ)=THVSTP(NZ,NY,NX)
    UPOMCs1(NZ)=UPOMC(NZ,NY,NX)
    UPNFs1(NZ)=UPNF(NZ,NY,NX)
    UPNO3s1(NZ)=UPNO3(NZ,NY,NX)
    UPNH4s1(NZ)=UPNH4(NZ,NY,NX)
    UPOMNs1(NZ)=UPOMN(NZ,NY,NX)
    UPH1Ps1(NZ)=UPH1P(NZ,NY,NX)
    UPH2Ps1(NZ)=UPH2P(NZ,NY,NX)
    UPOMPs1(NZ)=UPOMP(NZ,NY,NX)
    VOLWCs1(NZ)=VOLWC(NZ,NY,NX)
    VHCPCs1(NZ)=VHCPC(NZ,NY,NX)
    VCH4Fs1(NZ)=VCH4F(NZ,NY,NX)
    VCO2Fs1(NZ)=VCO2F(NZ,NY,NX)
    VN2OFs1(NZ)=VN2OF(NZ,NY,NX)
    VNH3Fs1(NZ)=VNH3F(NZ,NY,NX)
    VPO4Fs1(NZ)=VPO4F(NZ,NY,NX)
    VOLWPs1(NZ)=VOLWP(NZ,NY,NX)
    WSTRs1(NZ)=WSTR(NZ,NY,NX)
    WTRVXs1(NZ)=WTRVX(NZ,NY,NX)
    WTRVCs1(NZ)=WTRVC(NZ,NY,NX)
    WTLSs1(NZ)=WTLS(NZ,NY,NX)
    WTSHTs1(NZ)=WTSHT(NZ,NY,NX)
    WTSTGs1(NZ)=WTSTG(NZ,NY,NX)
    WTSTGNs1(NZ)=WTSTGN(NZ,NY,NX)
    WTSTGPs1(NZ)=WTSTGP(NZ,NY,NX)
    WTNDs1(NZ)=WTND(NZ,NY,NX)
    WTRTts1(NZ)=WTRT(NZ,NY,NX)
    WTNDNs1(NZ)=WTNDN(NZ,NY,NX)
    WTRTNs1(NZ)=WTRTN(NZ,NY,NX)
    WTSHNs1(NZ)=WTSHN(NZ,NY,NX)
    WTRVNs1(NZ)=WTRVN(NZ,NY,NX)
    WTNDPs1(NZ)=WTNDP(NZ,NY,NX)
    WTRTPs1(NZ)=WTRTP(NZ,NY,NX)
    WTSHPs1(NZ)=WTSHP(NZ,NY,NX)
    WTRVPs1(NZ)=WTRVP(NZ,NY,NX)
    XKCO24s1(NZ)=XKCO24(NZ,NY,NX)
    XTLIs1(NZ)=XTLI(NZ,NY,NX)
    XRNIs1(NZ)=XRNI(NZ,NY,NX)
    XRLAs1(NZ)=XRLA(NZ,NY,NX)
    XDLs1(NZ)=XDL(NZ,NY,NX)
    XPPDs1(NZ)=XPPD(NZ,NY,NX)
    ZPOOLPs1(NZ)=ZPOOLP(NZ,NY,NX)
    ZPOLNPs1(NZ)=ZPOLNP(NZ,NY,NX)
    ZEROLs1(NZ)=ZEROL(NZ,NY,NX)
    ZEROPs1(NZ)=ZEROP(NZ,NY,NX)
    ZCs1(NZ)=ZC(NZ,NY,NX)
    ZNPPs1(NZ)=ZNPP(NZ,NY,NX)

    DO  N=1,JLI
      CLASSs1(N,NZ)=CLASS(N,NZ,NY,NX)
    ENDDO

    DO L=1,NL(NY,NX)
      DO K=0,jcplx1
        DO N=1,2
          RDFOMCs1(N,K,L,NZ)=RDFOMC(N,K,L,NZ,NY,NX)
          RDFOMNs1(N,K,L,NZ)=RDFOMN(N,K,L,NZ,NY,NX)
          RDFOMPs1(N,K,L,NZ)=RDFOMP(N,K,L,NZ,NY,NX)
        ENDDO
      ENDDO
    ENDDO

    DO NB=1,NBR(NZ,NY,NX)
      ATRPs1(NB,NZ)=ATRP(NB,NZ,NY,NX)
      ARLFZs1(NB,NZ)=ARLFZ(NB,NZ,NY,NX)
      ARLFBs1(NB,NZ)=ARLFB(NB,NZ,NY,NX)
      CPOOLs1(NB,NZ)=CPOOL(NB,NZ,NY,NX)
      CPOLNBs1(NB,NZ)=CPOLNB(NB,NZ,NY,NX)
      CCPOLBs1(NB,NZ)=CCPOLB(NB,NZ,NY,NX)
      CZPOLBs1(NB,NZ)=CZPOLB(NB,NZ,NY,NX)
      CPPOLBs1(NB,NZ)=CPPOLB(NB,NZ,NY,NX)
      DGSTGIs1(NB,NZ)=DGSTGI(NB,NZ,NY,NX)
      DGSTGFs1(NB,NZ)=DGSTGF(NB,NZ,NY,NX)
      FLG4s1(NB,NZ)=FLG4(NB,NZ,NY,NX)
      FDBKs1(NB,NZ)=FDBK(NB,NZ,NY,NX)
      FDBKXs1(NB,NZ)=FDBKX(NB,NZ,NY,NX)
      FLGZs1(NB,NZ)=FLGZ(NB,NZ,NY,NX)
      GROUPs1(NB,NZ)=GROUP(NB,NZ,NY,NX)
      GSTGIs1(NB,NZ)=GSTGI(NB,NZ,NY,NX)
      GSTGFs1(NB,NZ)=GSTGF(NB,NZ,NY,NX)
      GRNXBs1(NB,NZ)=GRNXB(NB,NZ,NY,NX)
      GRNOBs1(NB,NZ)=GRNOB(NB,NZ,NY,NX)
      GRWTBs1(NB,NZ)=GRWTB(NB,NZ,NY,NX)
      HTSHEXs1(NB,NZ)=HTSHEX(NB,NZ,NY,NX)
      IDTHBs1(NB,NZ)=IDTHB(NB,NZ,NY,NX)
      IFLGPs1(NB,NZ)=IFLGP(NB,NZ,NY,NX)
      IFLGFs1(NB,NZ)=IFLGF(NB,NZ,NY,NX)
      IFLGEs1(NB,NZ)=IFLGE(NB,NZ,NY,NX)
      IFLGAs1(NB,NZ)=IFLGA(NB,NZ,NY,NX)
      IFLGGs1(NB,NZ)=IFLGG(NB,NZ,NY,NX)
      IFLGRs1(NB,NZ)=IFLGR(NB,NZ,NY,NX)
      IFLGQs1(NB,NZ)=IFLGQ(NB,NZ,NY,NX)
      KVSTGs1(NB,NZ)=KVSTG(NB,NZ,NY,NX)
      KLEAFs1(NB,NZ)=KLEAF(NB,NZ,NY,NX)
      KVSTGNs1(NB,NZ)=KVSTGN(NB,NZ,NY,NX)
      KLEAFXs1(NB,NZ)=KLEAFX(NB,NZ,NY,NX)
      NBTBs1(NB,NZ)=NBTB(NB,NZ,NY,NX)
      PSTGs1(NB,NZ)=PSTG(NB,NZ,NY,NX)
      PSTGIs1(NB,NZ)=PSTGI(NB,NZ,NY,NX)
      PSTGFs1(NB,NZ)=PSTGF(NB,NZ,NY,NX)
      PPOOLs1(NB,NZ)=PPOOL(NB,NZ,NY,NX)
      PPOLNBs1(NB,NZ)=PPOLNB(NB,NZ,NY,NX)
      RCCLXs1(NB,NZ)=RCCLX(NB,NZ,NY,NX)
      RCZLXs1(NB,NZ)=RCZLX(NB,NZ,NY,NX)
      RCPLXs1(NB,NZ)=RCPLX(NB,NZ,NY,NX)
      RCCSXs1(NB,NZ)=RCCSX(NB,NZ,NY,NX)
      RCZSXs1(NB,NZ)=RCZSX(NB,NZ,NY,NX)
      RCPSXs1(NB,NZ)=RCPSX(NB,NZ,NY,NX)
      RNH3Bs1(NB,NZ)=RNH3B(NB,NZ,NY,NX)
      TGSTGIs1(NB,NZ)=TGSTGI(NB,NZ,NY,NX)
      TGSTGFs1(NB,NZ)=TGSTGF(NB,NZ,NY,NX)
      VSTGXs1(NB,NZ)=VSTGX(NB,NZ,NY,NX)
      VSTGs1(NB,NZ)=VSTG(NB,NZ,NY,NX)
      VRNYs1(NB,NZ)=VRNY(NB,NZ,NY,NX)
      VRNZs1(NB,NZ)=VRNZ(NB,NZ,NY,NX)
      VRNSs1(NB,NZ)=VRNS(NB,NZ,NY,NX)
      VRNLs1(NB,NZ)=VRNL(NB,NZ,NY,NX)
      VRNFs1(NB,NZ)=VRNF(NB,NZ,NY,NX)
      VRNXs1(NB,NZ)=VRNX(NB,NZ,NY,NX)
      WTLSBs1(NB,NZ)=WTLSB(NB,NZ,NY,NX)
      WTRSVBs1(NB,NZ)=WTRSVB(NB,NZ,NY,NX)
      WTLFBs1(NB,NZ)=WTLFB(NB,NZ,NY,NX)
      WTNDBs1(NB,NZ)=WTNDB(NB,NZ,NY,NX)
      WTSHEBs1(NB,NZ)=WTSHEB(NB,NZ,NY,NX)
      WTEARBs1(NB,NZ)=WTEARB(NB,NZ,NY,NX)
      WTHSKBs1(NB,NZ)=WTHSKB(NB,NZ,NY,NX)
      WTRSBNs1(NB,NZ)=WTRSBN(NB,NZ,NY,NX)
      WTLFBNs1(NB,NZ)=WTLFBN(NB,NZ,NY,NX)
      WTNDBNs1(NB,NZ)=WTNDBN(NB,NZ,NY,NX)
      WTSHBNs1(NB,NZ)=WTSHBN(NB,NZ,NY,NX)
      WTEABNs1(NB,NZ)=WTEABN(NB,NZ,NY,NX)
      WTHSBNs1(NB,NZ)=WTHSBN(NB,NZ,NY,NX)
      WTRSBPs1(NB,NZ)=WTRSBP(NB,NZ,NY,NX)
      WTLFBPs1(NB,NZ)=WTLFBP(NB,NZ,NY,NX)
      WTNDBPs1(NB,NZ)=WTNDBP(NB,NZ,NY,NX)
      WTSHBPs1(NB,NZ)=WTSHBP(NB,NZ,NY,NX)
      WTEABPs1(NB,NZ)=WTEABP(NB,NZ,NY,NX)
      WTHSBPs1(NB,NZ)=WTHSBP(NB,NZ,NY,NX)
      WTGRBs1(NB,NZ)=WTGRB(NB,NZ,NY,NX)
      WTGRBNs1(NB,NZ)=WTGRBN(NB,NZ,NY,NX)
      WTGRBPs1(NB,NZ)=WTGRBP(NB,NZ,NY,NX)
      WTSTKBs1(NB,NZ)=WTSTKB(NB,NZ,NY,NX)
      WTSTBNs1(NB,NZ)=WTSTBN(NB,NZ,NY,NX)
      WTSTBPs1(NB,NZ)=WTSTBP(NB,NZ,NY,NX)
      WTSHTBs1(NB,NZ)=WTSHTB(NB,NZ,NY,NX)
      WTSHTNs1(NB,NZ)=WTSHTN(NB,NZ,NY,NX)
      WTSHTPs1(NB,NZ)=WTSHTP(NB,NZ,NY,NX)
      WGLFXs1(NB,NZ)=WGLFX(NB,NZ,NY,NX)
      WGLFNXs1(NB,NZ)=WGLFNX(NB,NZ,NY,NX)
      WGLFPXs1(NB,NZ)=WGLFPX(NB,NZ,NY,NX)
      WGSHEXs1(NB,NZ)=WGSHEX(NB,NZ,NY,NX)
      WGSHNXs1(NB,NZ)=WGSHNX(NB,NZ,NY,NX)
      WGSHPXs1(NB,NZ)=WGSHPX(NB,NZ,NY,NX)
      WTSTXBs1(NB,NZ)=WTSTXB(NB,NZ,NY,NX)
      WTSTXNs1(NB,NZ)=WTSTXN(NB,NZ,NY,NX)
      WTSTXPs1(NB,NZ)=WTSTXP(NB,NZ,NY,NX)
      WVSTKBs1(NB,NZ)=WVSTKB(NB,NZ,NY,NX)
      ZPOOLs1(NB,NZ)=ZPOOL(NB,NZ,NY,NX)
      ZPOLNBs1(NB,NZ)=ZPOLNB(NB,NZ,NY,NX)
      DO M=1,10
        IDAYs1(M,NB,NZ)=IDAY(M,NB,NZ,NY,NX)
      ENDDO
      DO K=1,JNODS
        DO  L=1,JC
          DO N=1,JLI
            SURFs1(N,L,K,NB,NZ)=SURF(N,L,K,NB,NZ,NY,NX)
            SURFXs1(N,L,K,NB,NZ)=SURFX(N,L,K,NB,NZ,NY,NX)
          ENDDO
        ENDDO
        CPOOL3s1(K,NB,NZ)=CPOOL3(K,NB,NZ,NY,NX)
        CPOOL4s1(K,NB,NZ)=CPOOL4(K,NB,NZ,NY,NX)
        CO2Bs1(K,NB,NZ)=CO2B(K,NB,NZ,NY,NX)
        COMPLs1(K,NB,NZ)=COMPL(K,NB,NZ,NY,NX)
        CBXNs1(K,NB,NZ)=CBXN(K,NB,NZ,NY,NX)
        CBXN4s1(K,NB,NZ)=CBXN4(K,NB,NZ,NY,NX)
        ETGROs1(K,NB,NZ)=ETGRO(K,NB,NZ,NY,NX)
        ETGR4s1(K,NB,NZ)=ETGR4(K,NB,NZ,NY,NX)
        FDBK4s1(K,NB,NZ)=FDBK4(K,NB,NZ,NY,NX)
        HCOBs1(K,NB,NZ)=HCOB(K,NB,NZ,NY,NX)
        VCGROs1(K,NB,NZ)=VCGRO(K,NB,NZ,NY,NX)
        VGROs1(K,NB,NZ)=VGRO(K,NB,NZ,NY,NX)
        VCGR4s1(K,NB,NZ)=VCGR4(K,NB,NZ,NY,NX)
        VGRO4s1(K,NB,NZ)=VGRO4(K,NB,NZ,NY,NX)
      ENDDO
      DO K=0,JNODS
        ARLF1s1(K,NB,NZ)=ARLF(K,NB,NZ,NY,NX)
        HTNODXs1(K,NB,NZ)=HTNODX(K,NB,NZ,NY,NX)
        HTSHEs1(K,NB,NZ)=HTSHE(K,NB,NZ,NY,NX)
        HTNODEs1(K,NB,NZ)=HTNODE(K,NB,NZ,NY,NX)
        WGNODEs1(K,NB,NZ)=WGNODE(K,NB,NZ,NY,NX)
        WGNODNs1(K,NB,NZ)=WGNODN(K,NB,NZ,NY,NX)
        WGNODPs1(K,NB,NZ)=WGNODP(K,NB,NZ,NY,NX)
        WGLFs1(K,NB,NZ)=WGLF(K,NB,NZ,NY,NX)
        WGLFNs1(K,NB,NZ)=WGLFN(K,NB,NZ,NY,NX)
        WGLFPs1(K,NB,NZ)=WGLFP(K,NB,NZ,NY,NX)
        WSLFs1(K,NB,NZ)=WSLF(K,NB,NZ,NY,NX)
        WGSHEs1(K,NB,NZ)=WGSHE(K,NB,NZ,NY,NX)
        WGSHNs1(K,NB,NZ)=WGSHN(K,NB,NZ,NY,NX)
        WGSHPs1(K,NB,NZ)=WGSHP(K,NB,NZ,NY,NX)
        WSSHEs1(K,NB,NZ)=WSSHE(K,NB,NZ,NY,NX)
      ENDDO
      DO L=1,JC
        DO N=1,JLI
          SURFBs1(N,L,NB,NZ)=SURFB(N,L,NB,NZ,NY,NX)
        ENDDO

      ENDDO

      DO K=0,JNODS
        DO  L=1,JC
          ARLFLs1(L,K,NB,NZ)=ARLFL(L,K,NB,NZ,NY,NX)
          WGLFLs1(L,K,NB,NZ)=WGLFL(L,K,NB,NZ,NY,NX)
          WGLFLNs1(L,K,NB,NZ)=WGLFLN(L,K,NB,NZ,NY,NX)
          WGLFLPs1(L,K,NB,NZ)=WGLFLP(L,K,NB,NZ,NY,NX)
        ENDDO
      ENDDO
      DO  L=1,JC
        ARSTKs1(L,NB,NZ)=ARSTK(L,NB,NZ,NY,NX)
      ENDDO
    enddo

    DO L=1,NL(NY,NX)
      DO N=1,MY(NZ,NY,NX)
        CPOOLRs1(N,L,NZ)=CPOOLR(N,L,NZ,NY,NX)
        CCPOLRs1(N,L,NZ)=CCPOLR(N,L,NZ,NY,NX)
        CZPOLRs1(N,L,NZ)=CZPOLR(N,L,NZ,NY,NX)
        CPPOLRs1(N,L,NZ)=CPPOLR(N,L,NZ,NY,NX)
        CO2Ps1(N,L,NZ)=CO2P(N,L,NZ,NY,NX)
        CO2As1(N,L,NZ)=CO2A(N,L,NZ,NY,NX)
        CH4Ps1(N,L,NZ)=CH4P(N,L,NZ,NY,NX)
        CH4As1(N,L,NZ)=CH4A(N,L,NZ,NY,NX)
        CWSRTLs1(N,L,NZ)=CWSRTL(N,L,NZ,NY,NX)
        H2GPs1(N,L,NZ)=H2GP(N,L,NZ,NY,NX)
        H2GAs1(N,L,NZ)=H2GA(N,L,NZ,NY,NX)
        OXYPs1(N,L,NZ)=OXYP(N,L,NZ,NY,NX)
        OXYAs1(N,L,NZ)=OXYA(N,L,NZ,NY,NX)
        PSIRTs1(N,L,NZ)=PSIRT(N,L,NZ,NY,NX)
        PSIROs1(N,L,NZ)=PSIRO(N,L,NZ,NY,NX)
        PSIRGs1(N,L,NZ)=PSIRG(N,L,NZ,NY,NX)
        PPOOLRs1(N,L,NZ)=PPOOLR(N,L,NZ,NY,NX)
        RUPNHBs1(N,L,NZ)=RUPNHB(N,L,NZ,NY,NX)
        RUPNH4s1(N,L,NZ)=RUPNH4(N,L,NZ,NY,NX)
        RUPH2Ps1(N,L,NZ)=RUPH2P(N,L,NZ,NY,NX)
        RUPNOBs1(N,L,NZ)=RUPNOB(N,L,NZ,NY,NX)
        RUPNO3s1(N,L,NZ)=RUPNO3(N,L,NZ,NY,NX)
        RUPH1Bs1(N,L,NZ)=RUPH1B(N,L,NZ,NY,NX)
        RUPH1Ps1(N,L,NZ)=RUPH1P(N,L,NZ,NY,NX)
        RUPH2Bs1(N,L,NZ)=RUPH2B(N,L,NZ,NY,NX)
        RUONHBs1(N,L,NZ)=RUONHB(N,L,NZ,NY,NX)
        RUONH4s1(N,L,NZ)=RUONH4(N,L,NZ,NY,NX)
        RUOH2Ps1(N,L,NZ)=RUOH2P(N,L,NZ,NY,NX)
        RUONOBs1(N,L,NZ)=RUONOB(N,L,NZ,NY,NX)
        RUONO3s1(N,L,NZ)=RUONO3(N,L,NZ,NY,NX)
        RUOH1Bs1(N,L,NZ)=RUOH1B(N,L,NZ,NY,NX)
        RUOH1Ps1(N,L,NZ)=RUOH1P(N,L,NZ,NY,NX)
        RUOH2Bs1(N,L,NZ)=RUOH2B(N,L,NZ,NY,NX)
        RUCNHBs1(N,L,NZ)=RUCNHB(N,L,NZ,NY,NX)
        RUCNH4s1(N,L,NZ)=RUCNH4(N,L,NZ,NY,NX)
        RUCH2Ps1(N,L,NZ)=RUCH2P(N,L,NZ,NY,NX)
        RUCNOBs1(N,L,NZ)=RUCNOB(N,L,NZ,NY,NX)
        RUCNO3s1(N,L,NZ)=RUCNO3(N,L,NZ,NY,NX)
        RUCH1Bs1(N,L,NZ)=RUCH1B(N,L,NZ,NY,NX)
        RUCH1Ps1(N,L,NZ)=RUCH1P(N,L,NZ,NY,NX)
        RUCH2Bs1(N,L,NZ)=RUCH2B(N,L,NZ,NY,NX)
        RCO2Ms1(N,L,NZ)=RCO2M(N,L,NZ,NY,NX)
        RCO2Ns1(N,L,NZ)=RCO2N(N,L,NZ,NY,NX)
        RCO2As1(N,L,NZ)=RCO2A(N,L,NZ,NY,NX)
        RTN1s1(N,L,NZ)=RTN1(N,L,NZ,NY,NX)
        RTNLs1(N,L,NZ)=RTNL(N,L,NZ,NY,NX)
        RTLGPs1(N,L,NZ)=RTLGP(N,L,NZ,NY,NX)
        RTDNPs1(N,L,NZ)=RTDNP(N,L,NZ,NY,NX)
        RTVLPs1(N,L,NZ)=RTVLP(N,L,NZ,NY,NX)
        RTVLWs1(N,L,NZ)=RTVLW(N,L,NZ,NY,NX)
        RRAD1s1(N,L,NZ)=RRAD1(N,L,NZ,NY,NX)
        RRAD2s1(N,L,NZ)=RRAD2(N,L,NZ,NY,NX)
        RTARPs1(N,L,NZ)=RTARP(N,L,NZ,NY,NX)
        RTLGAs1(N,L,NZ)=RTLGA(N,L,NZ,NY,NX)
        RCO2Ps1(N,L,NZ)=RCO2P(N,L,NZ,NY,NX)
        RUPOXPs1(N,L,NZ)=RUPOXP(N,L,NZ,NY,NX)
        RCO2Ss1(N,L,NZ)=RCO2S(N,L,NZ,NY,NX)
        RUPOXSs1(N,L,NZ)=RUPOXS(N,L,NZ,NY,NX)
        RUPCHSs1(N,L,NZ)=RUPCHS(N,L,NZ,NY,NX)
        RUPN2Ss1(N,L,NZ)=RUPN2S(N,L,NZ,NY,NX)
        RUPN3Ss1(N,L,NZ)=RUPN3S(N,L,NZ,NY,NX)
        RUPN3Bs1(N,L,NZ)=RUPN3B(N,L,NZ,NY,NX)
        RUPHGSs1(N,L,NZ)=RUPHGS(N,L,NZ,NY,NX)
        RCOFLAs1(N,L,NZ)=RCOFLA(N,L,NZ,NY,NX)
        ROXFLAs1(N,L,NZ)=ROXFLA(N,L,NZ,NY,NX)
        RCHFLAs1(N,L,NZ)=RCHFLA(N,L,NZ,NY,NX)
        RN2FLAs1(N,L,NZ)=RN2FLA(N,L,NZ,NY,NX)
        RNHFLAs1(N,L,NZ)=RNHFLA(N,L,NZ,NY,NX)
        RHGFLAs1(N,L,NZ)=RHGFLA(N,L,NZ,NY,NX)
        RCODFAs1(N,L,NZ)=RCODFA(N,L,NZ,NY,NX)
        ROXDFAs1(N,L,NZ)=ROXDFA(N,L,NZ,NY,NX)
        RCHDFAs1(N,L,NZ)=RCHDFA(N,L,NZ,NY,NX)
        RN2DFAs1(N,L,NZ)=RN2DFA(N,L,NZ,NY,NX)
        RNHDFAs1(N,L,NZ)=RNHDFA(N,L,NZ,NY,NX)
        RHGDFAs1(N,L,NZ)=RHGDFA(N,L,NZ,NY,NX)
        ROXYPs1(N,L,NZ)=ROXYP(N,L,NZ,NY,NX)
        RUNNHPs1(N,L,NZ)=RUNNHP(N,L,NZ,NY,NX)
        RUNNBPs1(N,L,NZ)=RUNNBP(N,L,NZ,NY,NX)
        RUNNOPs1(N,L,NZ)=RUNNOP(N,L,NZ,NY,NX)
        RUNNXPs1(N,L,NZ)=RUNNXP(N,L,NZ,NY,NX)
        RUPP2Ps1(N,L,NZ)=RUPP2P(N,L,NZ,NY,NX)
        RUPP2Bs1(N,L,NZ)=RUPP2B(N,L,NZ,NY,NX)
        RUPP1Ps1(N,L,NZ)=RUPP1P(N,L,NZ,NY,NX)
        RUPP1Bs1(N,L,NZ)=RUPP1B(N,L,NZ,NY,NX)
        UPWTRs1(N,L,NZ)=UPWTR(N,L,NZ,NY,NX)
        WFRs1(N,L,NZ)=WFR(N,L,NZ,NY,NX)
        WTRTLs1(N,L,NZ)=WTRTL(N,L,NZ,NY,NX)
        WTRTDs1(N,L,NZ)=WTRTD(N,L,NZ,NY,NX)
        WSRTLs1(N,L,NZ)=WSRTL(N,L,NZ,NY,NX)
        ZPOOLRs1(N,L,NZ)=ZPOOLR(N,L,NZ,NY,NX)
        Z2OPs1(N,L,NZ)=Z2OP(N,L,NZ,NY,NX)
        Z2OAs1(N,L,NZ)=Z2OA(N,L,NZ,NY,NX)
        ZH3Ps1(N,L,NZ)=ZH3P(N,L,NZ,NY,NX)
        ZH3As1(N,L,NZ)=ZH3A(N,L,NZ,NY,NX)
      enddo
      CPOOLNs1(L,NZ)=CPOOLN(L,NZ,NY,NX)
      PPOOLNs1(L,NZ)=PPOOLN(L,NZ,NY,NX)
      RUPNFs1(L,NZ)=RUPNF(L,NZ,NY,NX)
      TFN4s1(L,NZ)=TFN4(L,NZ,NY,NX)
      WTNDLNs1(L,NZ)=WTNDLN(L,NZ,NY,NX)
      WTNDLs1(L,NZ)=WTNDL(L,NZ,NY,NX)
      WTNDLPs1(L,NZ)=WTNDLP(L,NZ,NY,NX)
      ZPOOLNs1(L,NZ)=ZPOOLN(L,NZ,NY,NX)
    ENDDO
    DO L=1,JC
      ARSTVs1(L,NZ)=ARSTV(L,NZ,NY,NX)
      ARLFVs1(L,NZ)=ARLFV(L,NZ,NY,NX)
      WGLFVs1(L,NZ)=WGLFV(L,NZ,NY,NX)
    ENDDO
    DO N=1,MY(NZ,NY,NX)
      DMVLs1(N,NZ)=DMVL(N,NZ,NY,NX)
      PORTs1(N,NZ)=PORT(N,NZ,NY,NX)
      PORTXs1(N,NZ)=PORTX(N,NZ,NY,NX)
      RTAR2Xs1(N,NZ)=RTAR2X(N,NZ,NY,NX)
      RTAR1Xs1(N,NZ)=RTAR1X(N,NZ,NY,NX)
      RRAD1Xs1(N,NZ)=RRAD1X(N,NZ,NY,NX)
      RRAD2Xs1(N,NZ)=RRAD2X(N,NZ,NY,NX)
      RTLG1Xs1(N,NZ)=RTLG1X(N,NZ,NY,NX)
      RRADPs1(N,NZ)=RRADP(N,NZ,NY,NX)
      RTLG2Xs1(N,NZ)=RTLG2X(N,NZ,NY,NX)
      RSRRs1(N,NZ)=RSRR(N,NZ,NY,NX)
      RSRAs1(N,NZ)=RSRA(N,NZ,NY,NX)
      RRAD1Ms1(N,NZ)=RRAD1M(N,NZ,NY,NX)
      RRAD2Ms1(N,NZ)=RRAD2M(N,NZ,NY,NX)
      UPMNPOs1(N,NZ)=UPMNPO(N,NZ,NY,NX)
      UPMXPOs1(N,NZ)=UPMXPO(N,NZ,NY,NX)
      UPKMPOs1(N,NZ)=UPKMPO(N,NZ,NY,NX)
      UPMNZOs1(N,NZ)=UPMNZO(N,NZ,NY,NX)
      UPMXZOs1(N,NZ)=UPMXZO(N,NZ,NY,NX)
      UPKMZOs1(N,NZ)=UPKMZO(N,NZ,NY,NX)
      UPMNZHs1(N,NZ)=UPMNZH(N,NZ,NY,NX)
      UPMXZHs1(N,NZ)=UPMXZH(N,NZ,NY,NX)
      UPKMZHs1(N,NZ)=UPKMZH(N,NZ,NY,NX)
    ENDDO

    DO NR=1,NRT(NZ,NY,NX)
      NINRs1(NR,NZ)=NINR(NR,NZ,NY,NX)
      DO L=1,NJ(NY,NX)
        DO N=1,MY(NZ,NY,NX)
          RTLG1s1(N,L,NR,NZ)=RTLG1(N,L,NR,NZ,NY,NX)
          RTLG2s1(N,L,NR,NZ)=RTLG2(N,L,NR,NZ,NY,NX)
          RTN2s1(N,L,NR,NZ)=RTN2(N,L,NR,NZ,NY,NX)
          WTRT2s1(N,L,NR,NZ)=WTRT2(N,L,NR,NZ,NY,NX)
          WTRT1s1(N,L,NR,NZ)=WTRT1(N,L,NR,NZ,NY,NX)
          WTRT2Ns1(N,L,NR,NZ)=WTRT2N(N,L,NR,NZ,NY,NX)
          WTRT1Ns1(N,L,NR,NZ)=WTRT1N(N,L,NR,NZ,NY,NX)
          WTRT2Ps1(N,L,NR,NZ)=WTRT2P(N,L,NR,NZ,NY,NX)
          WTRT1Ps1(N,L,NR,NZ)=WTRT1P(N,L,NR,NZ,NY,NX)
        enddo
      enddo
      DO N=1,MY(NZ,NY,NX)
        RTDP1s1(N,NR,NZ)=RTDP1(N,NR,NZ,NY,NX)
        RTWT1s1(N,NR,NZ)=RTWT1(N,NR,NZ,NY,NX)
        RTWT1Ns1(N,NR,NZ)=RTWT1N(N,NR,NZ,NY,NX)
        RTWT1Ps1(N,NR,NZ)=RTWT1P(N,NR,NZ,NY,NX)
      enddo
    enddo
    DO M=1,4
      WTSTDGs1(M,NZ)=WTSTDG(M,NZ,NY,NX)
      WTSTDNs1(M,NZ)=WTSTDN(M,NZ,NY,NX)
      WTSTDPs1(M,NZ)=WTSTDP(M,NZ,NY,NX)
    ENDDO

    DO L=0,NJ(NY,NX)
      DO K=0,1
        DO M=1,4
          CSNCs1(M,K,L,NZ)=CSNC(M,K,L,NZ,NY,NX)
          PSNCs1(M,K,L,NZ)=PSNC(M,K,L,NZ,NY,NX)
          ZSNCs1(M,K,L,NZ)=ZSNC(M,K,L,NZ,NY,NX)
        enddo
      enddo
    ENDDO
    DO M=1,4
      DO N=0,5
        CFOPCs1(N,M,NZ)=CFOPC(N,M,NZ,NY,NX)
        CFOPNs1(N,M,NZ)=CFOPN(N,M,NZ,NY,NX)
        CFOPPs1(N,M,NZ)=CFOPP(N,M,NZ,NY,NX)
      enddo
    enddo
    DO L=1,JC
      DO  M=1,JSA
        DO  N=1,JLI
          PARs1(N,M,L,NZ)=PAR(N,M,L,NZ,NY,NX)
          PARDIFs1(N,M,L,NZ)=PARDIF(N,M,L,NZ,NY,NX)
        ENDDO
      ENDDO
    ENDDO
  ENDDO
  DO L=1,NL(NY,NX)
    DO M=1,NPH
      VOLWMs1(M,L)=VOLWM(M,L,NY,NX)
      VOLPMs1(M,L)=VOLPM(M,L,NY,NX)
      TORTs1(M,L)=TORT(M,L,NY,NX)
      FILMs1(M,L)=FILM(M,L,NY,NX)
      ROXSKs1(M,L)=ROXSK(M,L,NY,NX)
      THETPMs1(M,L)=THETPM(M,L,NY,NX)
      DFGSs1(M,L)=DFGS(M,L,NY,NX)
    ENDDO
  ENDDO
  end subroutine PlantAPISend

end module PlantAPI
